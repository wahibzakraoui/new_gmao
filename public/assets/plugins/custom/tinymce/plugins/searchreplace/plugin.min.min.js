!function(e){"use strict";var t,n,r,o=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},i=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=function(e){return function(){return e}},u=c(!1),l=c(!0),s=c("[!-#%-*,-\\/:;?@\\[-\\]_{}¡«·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]"),f=function(){return d},d=(t=function(e){return e.isNone()},{fold:function(e,t){return e()},is:u,isSome:u,isNone:l,getOr:r=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:r,orThunk:n,map:f,each:function(){},bind:f,exists:u,forall:l,filter:f,equals:t,equals_:t,toArray:function(){return[]},toString:c("none()")}),m=function(e){var t=c(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:l,isNone:u,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return m(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:d},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(u,(function(t){return n(e,t)}))}};return o},h={some:m,none:f,from:function(e){return null==e?d:m(e)}},g=s,p=tinymce.util.Tools.resolve("tinymce.util.Tools"),v=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},y=function(e){return function(t){return typeof t===e}},x=v("string"),w=v("array"),b=y("boolean"),O=y("function"),C=y("number"),N=Array.prototype.slice,T=Array.prototype.push,E=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},k=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},S=function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)},A=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!w(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);T.apply(t,e[n])}return t}(E(e,t))},D=Object.hasOwnProperty,M=function(e,t){return D.call(e,t)},B=(void 0!==e.window?e.window:Function("return this;")(),3,function(e){return 3===e.dom().nodeType}),F=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:c(e)}},I={fromHtml:function(t,n){var r=(n||e.document).createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||1<r.childNodes.length)throw e.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return F(r.childNodes[0])},fromTag:function(t,n){var r=(n||e.document).createElement(t);return F(r)},fromText:function(t,n){var r=(n||e.document).createTextNode(t);return F(r)},fromDom:F,fromPoint:function(e,t,n){var r=e.dom();return h.from(r.elementFromPoint(t,n)).map(F)}},P=function(e,t){return{element:c(e),offset:c(t)}},R=function(e,t){var n;(function(e,t){var n;(n=e,h.from(n.dom().parentNode).map(I.fromDom)).each((function(n){n.dom().insertBefore(t.dom(),e.dom())}))})(e,t),n=e,t.dom().appendChild(n.dom())},W=function(e,t){var n=function(t){return e(t)?h.from(t.dom().nodeValue):h.none()};return{get:function(r){if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom().nodeValue=r}}}(B,"text"),j=function(e){return W.get(e)},q=(O(e.Element.prototype.attachShadow)&&O(e.Node.prototype.getRootNode),function(t,n){return r=n,1!==(i=a=void 0===(o=t)?e.document:o.dom()).nodeType&&9!==i.nodeType&&11!==i.nodeType||0===i.childElementCount?[]:E(a.querySelectorAll(r),I.fromDom);var r,o,i,a}),V=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),_=function(e,t){return e.isBlock(t)||M(e.schema.getShortEndedElements(),t.nodeName)},H=function(e,t){return"false"===e.getContentEditable(t)},L=function(e,t){return!e.isBlock(t)&&M(e.schema.getWhiteSpaceElements(),t.nodeName)},U=function(e,t){return function(e,t){var n=E(e.dom().childNodes,I.fromDom);return 0<n.length&&t<n.length?P(n[t],0):P(e,t)}(I.fromDom(e),t)},$=function(e,t,n,r,o,i){void 0===i&&(i=!0);for(var a=i?t(!1):n;a;){var c=H(e,a);if(c||L(e,a)){if(c?r.cef(a):r.boundary(a))break;a=t(!0)}else{if(_(e,a)){if(r.boundary(a))break}else 3===a.nodeType&&r.text(a);if(a===o)break;a=t(!1)}}},z=function(e,t,n,r,o){if(!(_(i=e,a=n)||H(i,a)||L(i,a)||(u=a,"true"===(c=i).getContentEditable(u)&&"false"===c.getContentEditableParent(u.parentNode)))){var i,a,c,u,s=e.getParent(r,e.isBlock),f=new V(n,s),d=o?f.next:f.prev;$(e,d,n,{boundary:l,cef:l,text:function(e){o?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(I.fromDom(e))}})}},G=function(e,t,n,r,o,i){void 0===i&&(i=!0);var a=new V(n,t),c=[],u={sOffset:0,fOffset:0,elements:[]};z(e,u,n,t,!1);var l=function(){return 0<u.elements.length&&(c.push(u),u={sOffset:0,fOffset:0,elements:[]}),!1};return $(e,a.next,n,{boundary:l,cef:function(e){return l(),o&&c.push.apply(c,o.cef(e)),!1},text:function(e){u.elements.push(I.fromDom(e)),o&&o.text(e,u)}},r,i),r&&z(e,u,r,t,!0),l(),c},K=function(t,n){return n.collapsed?[]:function(t,n){var r=U(n.startContainer,n.startOffset),o=r.element().dom(),i=U(n.endContainer,n.endOffset),a=i.element().dom();return G(t,n.commonAncestorContainer,o,a,{text:function(e,t){e===a?t.fOffset+=e.length-i.offset():e===o&&(t.sOffset+=r.offset())},cef:function(n){var r,o,i;return r=A(q(I.fromDom(n),"*[contenteditable=true]"),(function(e){var n=e.dom();return G(t,n,n)})),o=function(t,n){return r=t.elements[0].dom(),o=n.elements[0].dom(),i=e.Node.DOCUMENT_POSITION_PRECEDING,0!=(r.compareDocumentPosition(o)&i)?1:-1;var r,o,i},(i=N.call(r,0)).sort(o),i}},!1)}(t,n)},J=function(e,t){var n=e.createRng();return n.selectNode(t),K(e,n)},Q=function(e,t){return A(t,(function(t){var n=t.elements,r=E(n,j).join("");return function(e,t){var n,r;return function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var c=e[i],u=t(c);u!==n&&(r.push(o),o=[]),n=u,o.push(c)}return 0!==o.length&&r.push(o),r}((n=function(e,n){var r=j(n),o=e.last,i=o+r.length,a=A(t,(function(e,t){return e.start<i&&e.finish>o?[{element:n,start:Math.max(o,e.start)-o,finish:Math.min(i,e.finish)-o,matchId:t}]:[]}));return{results:e.results.concat(a),last:i}},r={results:[],last:0},k(e,(function(e){r=n(r,e)})),r.results),(function(e){return e.matchId}))}(n,function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=e.length);var o=t.regex;o.lastIndex=n;for(var i,a=[];i=o.exec(e);){var c=i[t.matchIndex],u=i.index+i[0].indexOf(c),l=u+c.length;if(r<l)break;a.push({start:u,finish:l}),o.lastIndex=l}return a}(r,e,t.sOffset,r.length-t.fOffset))}))},X=function(t,n){S(t,(function(t,r){S(t,(function(t){var o=I.fromDom(n.cloneNode(!1));!function(t,n,r){!function(t,n,r){if(!(x(r)||b(r)||C(r)))throw e.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,r+"")}(t.dom(),n,r)}(o,"data-mce-index",r);var i=t.element.dom();if(i.length===t.finish&&0===t.start)R(t.element,o);else{i.length!==t.finish&&i.splitText(t.finish);var a=i.splitText(t.start);R(I.fromDom(a),o)}}))}))},Y=function(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t},Z=function(e,t,n,r){var o=e.dom.create("span",{"data-mce-bogus":1});o.className="mce-match-marker";var i,a,c,u,l,s=e.getBody();return le(e,t,!1),r?function(e,t,n,r){var o,i=n.getBookmark(),a=e.select("td[data-mce-selected],th[data-mce-selected]"),c=0<a.length?(o=e,A(a,(function(e){return J(o,e)}))):K(e,n.getRng()),u=Q(t,c);return X(u,r),n.moveToBookmark(i),u.length}(e.dom,n,e.selection,o):(i=e.dom,a=n,c=o,u=J(i,s),l=Q(a,u),X(l,c),l.length)},ee=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},te=function(e,t){var n=[],r=p.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(var o=0;o<r.length;o++){var i=Y(r[o]);null!==i&&i.length&&i===t.toString()&&n.push(r[o])}return n},ne=function(e,t,n){var r=t.get(),o=r.index,i=e.dom;(n=!1!==n)?o+1===r.count?o=0:o++:o-1==-1?o=r.count-1:o--,i.removeClass(te(e,r.index),"mce-match-marker-selected");var a=te(e,o);return a.length?(i.addClass(te(e,o),"mce-match-marker-selected"),e.selection.scrollIntoView(a[0]),o):-1},re=function(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)},oe=function(e,t,n,r,o,i){var a,c,u=(a=o,c="("+n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]")+")",a?"(?:^|\\s|"+g()+")"+c+"(?=$|\\s|"+g()+")":c),l={regex:new RegExp(u,r?"g":"gi"),matchIndex:1},s=Z(e,t,l,i);if(s){var f=ne(e,t,!0);t.set({index:f,count:s,text:n,matchCase:r,wholeWord:o,inSelection:i})}return s},ie=function(e,t){var n=ne(e,t,!0);t.set(a(a({},t.get()),{index:n}))},ae=function(e,t){var n=ne(e,t,!1);t.set(a(a({},t.get()),{index:n}))},ce=function(e){var t=Y(e);return null!==t&&0<t.length},ue=function(e,t,n,r,o){var i,c=t.get(),u=c.index,l=u;r=!1!==r;for(var s=e.getBody(),f=p.grep(p.toArray(s.getElementsByTagName("span")),ce),d=0;d<f.length;d++){var m=Y(f[d]),h=i=parseInt(m,10);if(o||h===c.index){for(n.length?(f[d].firstChild.nodeValue=n,ee(f[d])):re(e.dom,f[d]);f[++d];){if((h=parseInt(Y(f[d]),10))!==i){d--;break}re(e.dom,f[d])}r&&l--}else u<i&&f[d].setAttribute("data-mce-index",String(i-1))}return t.set(a(a({},c),{count:o?0:c.count-1,index:l})),(r?ie:ae)(e,t),!o&&0<t.get().count},le=function(e,t,n){var r,o,i,c=t.get(),u=p.toArray(e.getBody().getElementsByTagName("span"));for(r=0;r<u.length;r++){var l=Y(u[r]);null!==l&&l.length&&(l===c.index.toString()&&(o=o||u[r].firstChild,i=u[r].firstChild),ee(u[r]))}if(t.set(a(a({},c),{index:-1,count:0,text:""})),o&&i){var s=e.dom.createRng();return s.setStart(o,0),s.setEnd(i,i.data.length),!1!==n&&e.selection.setRng(s),s}},se=tinymce.util.Tools.resolve("tinymce.Env"),fe=function(e,t){var n,r=(n=o(h.none()),{clear:function(){n.set(h.none())},set:function(e){n.set(h.some(e))},isSet:function(){return n.get().isSome()},on:function(e){n.get().each(e)}});e.undoManager.add();var i=p.trim(e.selection.getContent({format:"text"}));function c(e){(1<t.get().count?e.enable:e.disable)("next"),(1<t.get().count?e.enable:e.disable)("prev")}var u=function(e,t){var n=t?e.disable:e.enable;k(["replace","replaceall","prev","next"],n)},l=function(e,t){se.browser.isSafari()&&se.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},s=function(n){le(e,t,!1),u(n,!0),c(n)},f=function(n){var r=n.getData(),o=t.get();if(r.findtext.length){if(o.text===r.findtext&&o.matchCase===r.matchcase&&o.wholeWord===r.wholewords)ie(e,t);else{var i=oe(e,t,r.findtext,r.matchcase,r.wholewords,r.inselection);i<=0&&function(t){e.windowManager.alert("Could not find the specified string.",(function(){t.focus("findtext")}))}(n),u(n,0===i)}c(n)}else s(n)},d=t.get(),m={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace All",disabled:!0}],initialData:{findtext:i,replacetext:"",wholewords:d.wholeWord,matchcase:d.matchCase,inselection:d.inSelection},onChange:function(e,n){"findtext"===n.name&&0<t.get().count&&s(e)},onAction:function(n,r){var o,i,u=n.getData();switch(r.name){case"find":f(n);break;case"replace":(ue(e,t,u.replacetext)?c:s)(n);break;case"replaceall":ue(e,t,u.replacetext,!0,!0),s(n);break;case"prev":ae(e,t),c(n);break;case"next":ie(e,t),c(n);break;case"matchcase":case"wholewords":case"inselection":o=n.getData(),i=t.get(),t.set(a(a({},i),{matchCase:o.matchcase,wholeWord:o.wholewords,inSelection:o.inselection})),s(n)}l(n,r.name)},onSubmit:function(e){f(e),l(e,"find")},onClose:function(){e.focus(),le(e,t),e.undoManager.add()}};r.set(e.windowManager.open(m,{inline:"toolbar"}))},de=function(e,t){return function(){fe(e,t)}};i.add("searchreplace",(function(e){var t,n,r,i,a,c,u=o({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return n=u,(t=e).addCommand("SearchReplace",(function(){fe(t,n)})),i=u,(r=e).ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:de(r,i),icon:"search"}),r.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:de(r,i),icon:"search"}),r.shortcuts.add("Meta+F","",de(r,i)),a=e,c=u,{done:function(e){return le(a,c,e)},find:function(e,t,n,r){return void 0===r&&(r=!1),oe(a,c,e,t,n,r)},next:function(){return ie(a,c)},prev:function(){return ae(a,c)},replace:function(e,t,n){return ue(a,c,e,t,n)}}}))}(window);