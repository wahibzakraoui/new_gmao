!function(n){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(){},r=function(n){return function(){return n}},o=function(n){return n};function u(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}var i,c,a,l,f=function(n){return function(t){return!n(t)}},s=r(!1),d=r(!0),m=function(){return g},g=(i=function(n){return n.isNone()},{fold:function(n,t){return n()},is:s,isSome:s,isNone:d,getOr:a=function(n){return n},getOrThunk:c=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:a,orThunk:c,map:m,each:e,bind:m,exists:s,forall:d,filter:m,equals:i,equals_:i,toArray:function(){return[]},toString:r("none()")}),p=function(n){var t=r(n),e=function(){return u},o=function(t){return t(n)},u={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:d,isNone:s,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return p(t(n))},each:function(t){t(n)},bind:o,exists:o,forall:o,filter:function(t){return t(n)?u:g},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(s,(function(t){return e(n,t)}))}};return u},h={some:p,none:m,from:function(n){return null==n?g:p(n)}},v=function(n){return function(t){return r=typeof(e=t),(null===e?"null":"object"==r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===n;var e,r}},b=function(n){return function(t){return typeof t===n}},w=v("string"),y=v("object"),C=v("array"),x=b("boolean"),S=function(n){return!(null===(t=n)||void 0===t);var t},T=b("function"),R=b("number"),O=Array.prototype.slice,D=Array.prototype.indexOf,A=Array.prototype.push,B=function(n,t){return e=n,r=t,-1<D.call(e,r);var e,r},P=function(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return!0;return!1},E=function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e},I=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var u=n[o];r[o]=t(u,o)}return r},M=function(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e)},k=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var u=n[r];t(u,r)&&e.push(u)}return e},N=function(n,t,e){return function(n,t){for(var e=n.length-1;0<=e;e--)t(n[e])}(n,(function(n){e=t(e,n)})),e},_=function(n,t,e){return M(n,(function(n){e=t(e,n)})),e},W=function(n,t){return function(n,t,e){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(t(u,r))return h.some(u);if(e(u,r))break}return h.none()}(n,t,s)},j=function(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return h.some(e);return h.none()},z=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!C(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);A.apply(t,n[e])}return t},F=function(n,t){return z(I(n,t))},L=function(n,t){for(var e=0,r=n.length;e<r;++e)if(!0!==t(n[e],e))return!1;return!0},H=function(n){return 0===n.length?h.none():h.some(n[n.length-1])},q=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return h.none()},V=Object.keys,U=Object.hasOwnProperty,K=function(n,t){for(var e=V(n),r=0,o=e.length;r<o;r++){var u=e[r];t(n[u],u)}},$=function(n,t){return X(n,(function(n,e){return{k:e,v:t(n,e)}}))},X=function(n,t){var e={};return K(n,(function(n,r){var o=t(n,r);e[o.k]=o.v})),e},G=function(n,t){return Y(n,t)?h.from(n[t]):h.none()},Y=function(n,t){return U.call(n,t)},J=(void 0!==n.window?n.window:Function("return this;")(),function(n){return n.dom().nodeName.toLowerCase()}),Q=function(n){return n.dom().nodeType},Z=function(n){return function(t){return Q(t)===n}},nn=function(n){return 8===Q(n)||"#comment"===J(n)},tn=Z(1),en=Z(3),rn=Z(9),on=Z(11),un=function(t,e,r){if(!(w(r)||x(r)||R(r)))throw n.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,r+"")},cn=function(n,t,e){un(n.dom(),t,e)},an=function(n,t){var e=n.dom();K(t,(function(n,t){un(e,t,n)}))},ln=function(n,t){var e=n.dom().getAttribute(t);return null===e?void 0:e},fn=function(n,t){return h.from(ln(n,t))},sn=function(n,t){var e=n.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},dn=function(n,t){n.dom().removeAttribute(t)},mn=function(n){return _(n.dom().attributes,(function(n,t){return n[t.name]=t.value,n}),{})},gn=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},pn=function(n,t){return-1!==n.indexOf(t)},hn=function(n,t){return gn(n,t,n.length-t.length)},vn=(l=/^\s+|\s+$/g,function(n){return n.replace(l,"")}),bn=function(n){return 0<n.length},wn=function(n){return void 0!==n.style&&T(n.style.getPropertyValue)},yn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:r(n)}},Cn={fromHtml:function(t,e){var r=(e||n.document).createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||1<r.childNodes.length)throw n.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return yn(r.childNodes[0])},fromTag:function(t,e){var r=(e||n.document).createElement(t);return yn(r)},fromText:function(t,e){var r=(e||n.document).createTextNode(t);return yn(r)},fromDom:yn,fromPoint:function(n,t,e){var r=n.dom();return h.from(r.elementFromPoint(t,e)).map(yn)}},xn=function(){return(xn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},Sn=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},Tn=function(){return Rn(0,0)},Rn=function(n,t){return{major:n,minor:t}},On=function(n,t){var e=String(t).toLowerCase();return 0===n.length?Tn():function(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}}(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return Rn(r(1),r(2))}(n,e)},Dn=Tn,An="Firefox",Bn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(An),isSafari:r("Safari")}},Pn=function(){return Bn({current:void 0,version:Dn()})},En=Bn,In=(r("Edge"),r("Chrome"),r("IE"),r("Opera"),r(An),r("Safari"),"Windows"),Mn="Android",kn="Solaris",Nn="FreeBSD",_n="ChromeOS",Wn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r(In),isiOS:r("iOS"),isAndroid:r(Mn),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(kn),isFreeBSD:r(Nn),isChromeOS:r(_n)}},jn=function(){return Wn({current:void 0,version:Dn()})},zn=Wn,Fn=(r(In),r("iOS"),r(Mn),r("Linux"),r("OSX"),r(kn),r(Nn),r(_n),function(n,t){var e=String(t).toLowerCase();return W(n,(function(n){return n.search(e)}))}),Ln=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Hn=function(n){return function(t){return pn(t,n)}},qn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return pn(n,"edge/")&&pn(n,"chrome")&&pn(n,"safari")&&pn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ln],search:function(n){return pn(n,"chrome")&&!pn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return pn(n,"msie")||pn(n,"trident")}},{name:"Opera",versionRegexes:[Ln,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Hn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Hn("firefox")},{name:"Safari",versionRegexes:[Ln,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(pn(n,"safari")||pn(n,"mobile/"))&&pn(n,"applewebkit")}}],Vn=[{name:"Windows",search:Hn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return pn(n,"iphone")||pn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Hn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Hn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Hn("linux"),versionRegexes:[]},{name:"Solaris",search:Hn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Hn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Hn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Un={browsers:r(qn),oses:r(Vn)},Kn=function(n,t){var e,o,u,i,c,a,l,f,s,d,m,g,p=Un.browsers(),h=Un.oses(),v=function(n,t){return Fn(n,t).map((function(n){var e=On(n.versionRegexes,t);return{current:n.name,version:e}}))}(p,n).fold(Pn,En),b=function(n,t){return Fn(n,t).map((function(n){var e=On(n.versionRegexes,t);return{current:n.name,version:e}}))}(h,n).fold(jn,zn);return{browser:v,os:b,deviceType:(o=v,u=n,i=t,c=(e=b).isiOS()&&!0===/ipad/i.test(u),a=e.isiOS()&&!c,l=e.isiOS()||e.isAndroid(),f=l||i("(pointer:coarse)"),s=c||!a&&l&&i("(min-device-width:768px)"),d=a||l&&!s,m=o.isSafari()&&e.isiOS()&&!1===/safari/i.test(u),g=!d&&!s&&!m,{isiPad:r(c),isiPhone:r(a),isTablet:r(s),isPhone:r(d),isTouch:r(f),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:r(m),isDesktop:r(g)})}},$n=function(t){return n.window.matchMedia(t).matches},Xn=Sn((function(){return Kn(n.navigator.userAgent,$n)})),Gn=function(){return Xn()},Yn=function(n,t){var e=n.dom();if(1!==e.nodeType)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Jn=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},Qn=function(n,t){return n.dom()===t.dom()},Zn=function(t,e){return Gn().browser.isIE()?function(t,e){return r=t.dom(),o=e.dom(),u=n.Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(r.compareDocumentPosition(o)&u);var r,o,u}(t,e):(r=e,(o=t.dom())!==(u=r.dom())&&o.contains(u));var r,o,u},nt=Yn,tt=function(n){return Cn.fromDom(n.dom().ownerDocument)},et=function(n){return h.from(n.dom().parentNode).map(Cn.fromDom)},rt=function(n,t){for(var e=T(t)?t:s,r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=Cn.fromDom(u);if(o.push(i),!0===e(i))break;r=u}return o},ot=function(n){return h.from(n.dom().previousSibling).map(Cn.fromDom)},ut=function(n){return h.from(n.dom().nextSibling).map(Cn.fromDom)},it=function(n){return I(n.dom().childNodes,Cn.fromDom)},ct=function(n,t){var e=n.dom().childNodes;return h.from(e[t]).map(Cn.fromDom)},at=T(n.Element.prototype.attachShadow)&&T(n.Node.prototype.getRootNode),lt=r(at),ft=at?function(n){return Cn.fromDom(n.dom().getRootNode())}:function(n){return rn(n)?n:tt(n)},st=function(n){return Cn.fromDom(n.dom().host)},dt=function(n){return S(n.dom().shadowRoot)},mt=function(n){var t,e,r=en(n)?n.dom().parentNode:n.dom();return null!=r&&null!==r.ownerDocument&&function(n){var t=ft(n);return on(t)?h.some(t):h.none()}(Cn.fromDom(r)).fold((function(){return r.ownerDocument.body.contains(r)}),(t=mt,e=st,function(n){return t(e(n))}))},gt=function(n){var t=n.dom().body;if(null==t)throw new Error("Body is not available yet");return Cn.fromDom(t)},pt=function(t,e,r){if(!w(r))throw n.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);wn(t)&&t.style.setProperty(e,r)},ht=function(n,t,e){var r=n.dom();pt(r,t,e)},vt=function(n,t){var e=n.dom();K(t,(function(n,t){pt(e,t,n)}))},bt=function(t,e){var r=t.dom(),o=n.window.getComputedStyle(r).getPropertyValue(e);return""!==o||mt(t)?o:wt(r,e)},wt=function(n,t){return wn(n)?n.style.getPropertyValue(t):""},yt=function(n,t){var e=n.dom(),r=wt(e,t);return h.from(r).filter((function(n){return 0<n.length}))},Ct=function(n,t){var e,r,o=n.dom();r=t,wn(e=o)&&e.style.removeProperty(r),fn(n,"style").map(vn).is("")&&dn(n,"style")},xt=function(n,t){et(n).each((function(e){e.dom().insertBefore(t.dom(),n.dom())}))},St=function(n,t){ut(n).fold((function(){et(n).each((function(n){Rt(n,t)}))}),(function(n){xt(n,t)}))},Tt=function(n,t){ct(n,0).fold((function(){Rt(n,t)}),(function(e){n.dom().insertBefore(t.dom(),e.dom())}))},Rt=function(n,t){n.dom().appendChild(t.dom())},Ot=function(n,t){xt(n,t),Rt(t,n)},Dt=function(n,t){M(t,(function(e,r){var o=0===r?n:t[r-1];St(o,e)}))},At=function(n,t){M(t,(function(t){Rt(n,t)}))},Bt=function(n){n.dom().textContent="",M(it(n),(function(n){Pt(n)}))},Pt=function(n){var t=n.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},Et=function(n){var t,e=it(n);0<e.length&&(t=n,M(e,(function(n){xt(t,n)}))),Pt(n)},It=function(n,t,e){return{element:r(n),rowspan:r(t),colspan:r(e)}},Mt=function(n,t,e){return{element:r(n),cells:r(t),section:r(e)}},kt=function(n,t){return{element:r(n),isNew:r(t)}},Nt=function(n,t){return{cells:r(n),section:r(t)}},_t=function(n,t){var e=[];return M(it(n),(function(n){t(n)&&(e=e.concat([n])),e=e.concat(_t(n,t))})),e},Wt=function(n,t,e){return r=function(n){return Yn(n,t)},k(rt(n,e),r);var r},jt=function(n,t){return e=function(n){return Yn(n,t)},k(it(n),e);var e},zt=function(t,e){return r=e,u=void 0===(o=t)?n.document:o.dom(),Jn(u)?[]:I(u.querySelectorAll(r),Cn.fromDom);var r,o,u};function Ft(n,t,e,r,o){return n(e,r)?h.some(e):T(o)&&o(e)?h.none():t(e,r,o)}var Lt=function(n,t,e){for(var o=n.dom(),u=T(e)?e:r(!1);o.parentNode;){o=o.parentNode;var i=Cn.fromDom(o);if(t(i))return h.some(i);if(u(i))break}return h.none()},Ht=function(n,t,e){return Lt(n,(function(n){return Yn(n,t)}),e)},qt=function(n,t){return e=function(n){return Yn(n,t)},W(n.dom().childNodes,(function(n){return e(Cn.fromDom(n))})).map(Cn.fromDom);var e},Vt=function(t,e){return r=e,u=void 0===(o=t)?n.document:o.dom(),Jn(u)?h.none():h.from(u.querySelector(r)).map(Cn.fromDom);var r,o,u},Ut=function(n,t,e){return Ft((function(n,t){return Yn(n,t)}),Ht,n,t,e)},Kt=function(n,t,e){return void 0===e&&(e=0),fn(n,t).map((function(n){return parseInt(n,10)})).getOr(e)},$t=function(n,t){return Kt(n,t,1)},Xt=function(n){return 1<$t(n,"colspan")},Gt=function(n){return 1<$t(n,"rowspan")},Yt=function(n,t){return parseInt(bt(n,t),10)},Jt=r(10),Qt=r(10),Zt=function(n,t){return ne(n,t,r(!0))},ne=function(n,t,e){return F(it(n),(function(n){return Yn(n,t)?e(n)?[n]:[]:ne(n,t,e)}))},te=function(n,t){return function(n,t,e){return void 0===e&&(e=s),e(t)?h.none():B(n,J(t))?h.some(t):Ht(t,n.join(","),(function(n){return Yn(n,"table")||e(n)}))}(["td","th"],n,t)},ee=function(n){return Zt(n,"th,td")},re=function(n,t){return Ut(n,"table",t)},oe=function(n){return Zt(n,"tr")},ue=function(n){var t=oe(n);return I(t,(function(n){var t=n,e=et(t).map((function(n){var t=J(n);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"})).getOr("tbody"),r=I(ee(n),(function(n){var t=Kt(n,"rowspan",1),e=Kt(n,"colspan",1);return It(n,t,e)}));return Mt(t,r,e)}))},ie=function(n,t){return n+","+t},ce=function(n,t){var e=F(n.all,(function(n){return n.cells()}));return k(e,t)},ae=function(n){var t={},e=[],o=n.length,u=0;return M(n,(function(n,o){var i=[];M(n.cells(),(function(n){for(var e=0;void 0!==t[ie(o,e)];)e++;for(var c,a,l,f=(c=n.element(),a=n.rowspan(),l=n.colspan(),{element:r(c),rowspan:r(a),colspan:r(l),row:r(o),column:r(e)}),s=0;s<n.colspan();s++)for(var d=0;d<n.rowspan();d++){var m=e+s,g=ie(o+d,m);t[g]=f,u=Math.max(u,m+1)}i.push(f)})),e.push(Mt(n.element(),i,n.section()))})),{grid:{rows:r(o),columns:r(u)},access:t,all:e}},le=function(n){var t=ue(n);return ae(t)},fe=ae,se=function(n,t,e){var r=n.access[ie(t,e)];return void 0!==r?h.some(r):h.none()},de=function(n,t,e){var r=ce(n,(function(n){return e(t,n.element())}));return 0<r.length?h.some(r[0]):h.none()},me=ce,ge=function(n){var t=I(n.all,(function(n){return n.cells()}));return z(t)},pe=function(n,t){var e,r,o,u,i,c,a,l,f,s,d=function(n){return Yn(n.element(),t)},m=ue(n),g=fe(m),p=(r=d,o=(e=g).grid.columns(),u=e.grid.rows(),i=o,a=c=0,K(e.access,(function(n){if(r(n)){var t=n.row(),e=t+n.rowspan()-1,o=n.column(),l=o+n.colspan()-1;t<u?u=t:c<e&&(c=e),o<i?i=o:a<l&&(a=l)}})),{minRow:u,minCol:i,maxRow:c,maxCol:a}),h="th:not("+t+"),td:not("+t+")",v=ne(n,"th,td",(function(n){return Yn(n,h)}));return M(v,Pt),function(n,t,e,r){for(var o,u,i,c=t.grid.columns(),a=t.grid.rows(),l=0;l<a;l++)for(var f=!1,s=0;s<c;s++)l<e.minRow||l>e.maxRow||s<e.minCol||s>e.maxCol||(se(t,l,s).filter(r).isNone()?(o=f,u=n[l].element(),i=Cn.fromTag("td"),Rt(i,Cn.fromTag("br")),(o?Rt:Tt)(u,i)):f=!0)}(m,g,p,d),f=p,s=k(Zt(l=n,"tr"),(function(n){return 0===n.dom().childElementCount})),M(s,Pt),f.minCol!==f.maxCol&&f.minRow!==f.maxRow||M(Zt(l,"th,td"),(function(n){dn(n,"rowspan"),dn(n,"colspan")})),dn(l,"width"),dn(l,"height"),Ct(l,"width"),Ct(l,"height"),n},he=function(n,t){var e=function(t){return n(t)?h.from(t.dom().nodeValue):h.none()};return{get:function(r){if(!n(r))throw new Error("Can only get "+t+" value of a "+t+" node");return e(r).getOr("")},getOption:e,set:function(e,r){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom().nodeValue=r}}}(en,"text"),ve=function(n){return he.get(n)},be=function(n){return he.getOption(n)},we=function(n,t){return he.set(n,t)},ye=function(n){return"img"===J(n)?1:be(n).fold((function(){return it(n).length}),(function(n){return n.length}))},Ce=["img","br"],xe=function(n){return be(n).filter((function(n){return 0!==n.trim().length||-1<n.indexOf("Â ")})).isSome()||B(Ce,J(n))},Se=function(n){return t=xe,(e=function(n){for(var r=0;r<n.childNodes.length;r++){var o=Cn.fromDom(n.childNodes[r]);if(t(o))return h.some(o);var u=e(n.childNodes[r]);if(u.isSome())return u}return h.none()})(n.dom());var t,e},Te=function(n){return Re(n,xe)},Re=function(n,t){var e=function(n){for(var r=it(n),o=r.length-1;0<=o;o--){var u=r[o];if(t(u))return h.some(u);var i=e(u);if(i.isSome())return i}return h.none()};return e(n)},Oe=function(n,t){return Cn.fromDom(n.dom().cloneNode(t))},De=function(n){return Oe(n,!1)},Ae=function(n){return Oe(n,!0)},Be=function(){var n=Cn.fromTag("td");return Rt(n,Cn.fromTag("br")),n},Pe=function(n,t,e){var r=function(n,t){var e,r,o,u=(e=n,r=Cn.fromTag(t),o=mn(e),an(r,o),r),i=it(Ae(n));return At(u,i),u}(n,t);return K(e,(function(n,t){null===n?dn(r,t):cn(r,t,n)})),r},Ee=function(n){return n},Ie=function(n){return function(){return Cn.fromTag("tr",n.dom())}},Me=function(n,t,e){return{row:Ie(t),cell:function(t){var r,o,u,i,c,a,l=tt(t.element()),f=Cn.fromTag(J(t.element()),l.dom()),s=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),d=0<s.length?(r=t.element(),o=f,u=s,Se(r).map((function(n){var t=u.join(","),e=Wt(n,t,(function(n){return Qn(n,r)}));return N(e,(function(n,t){var e=De(t);return dn(e,"contenteditable"),Rt(n,e),e}),o)})).getOr(o)):f;return Rt(d,Cn.fromTag("br")),i=f,c=t.element().dom(),a=i.dom(),wn(c)&&wn(a)&&(a.style.cssText=c.style.cssText),Ct(f,"height"),1!==t.colspan()&&Ct(t.element(),"width"),n(t.element(),f),f},replace:Pe,gap:Be}},ke=function(n){return{row:Ie(n),cell:Be,replace:Ee,gap:Be}},Ne=function(n,t){var e=t.column(),r=t.column()+t.colspan()-1,o=t.row(),u=t.row()+t.rowspan()-1;return e<=n.finishCol()&&r>=n.startCol()&&o<=n.finishRow()&&u>=n.startRow()},_e=function(n,t){return t.column()>=n.startCol()&&t.column()+t.colspan()-1<=n.finishCol()&&t.row()>=n.startRow()&&t.row()+t.rowspan()-1<=n.finishRow()},We=function(n,t,e){var o=de(n,t,Qn),u=de(n,e,Qn);return o.bind((function(n){return u.map((function(t){return function(n,t){return e=Math.min(n.row(),t.row()),o=Math.min(n.column(),t.column()),u=Math.max(n.row()+n.rowspan()-1,t.row()+t.rowspan()-1),i=Math.max(n.column()+n.colspan()-1,t.column()+t.colspan()-1),{startRow:r(e),startCol:r(o),finishRow:r(u),finishCol:r(i)};var e,o,u,i}(n,t)}))}))},je=function(n,t,e){return We(n,t,e).map((function(t){var e=me(n,u(Ne,t));return I(e,(function(n){return n.element()}))}))},ze=function(n,t){return de(n,t,(function(n,t){return Zn(t,n)})).map((function(n){return n.element()}))},Fe=function(n,t,e,r,o){var u=Le(n),i=Qn(n,e)?h.some(t):ze(u,t),c=Qn(n,o)?h.some(r):ze(u,r);return i.bind((function(n){return c.bind((function(t){return je(u,n,t)}))}))},Le=le,He=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function qe(){return{up:r({selector:Ht,closest:Ut,predicate:Lt,all:rt}),down:r({selector:zt,predicate:_t}),styles:r({get:bt,getRaw:yt,set:ht,remove:Ct}),attrs:r({get:ln,set:cn,remove:dn,copyTo:function(n,t){var e=mn(n);an(t,e)}}),insert:r({before:xt,after:St,afterAll:Dt,append:Rt,appendAll:At,prepend:Tt,wrap:Ot}),remove:r({unwrap:Et,remove:Pt}),create:r({nu:Cn.fromTag,clone:function(n){return Cn.fromDom(n.dom().cloneNode(!1))},text:Cn.fromText}),query:r({comparePosition:function(n,t){return n.dom().compareDocumentPosition(t.dom())},prevSibling:ot,nextSibling:ut}),property:r({children:it,name:J,parent:et,document:function(n){return n.dom().ownerDocument},isText:en,isComment:nn,isElement:tn,getText:ve,setText:we,isBoundary:function(n){return!!tn(n)&&("body"===J(n)||B(He,J(n)))},isEmptyTag:function(n){return!!tn(n)&&B(["br","img","hr","input"],J(n))},isNonEditable:function(n){return tn(n)&&"false"===ln(n,"contenteditable")}}),eq:Qn,is:nt}}var Ve=function(n,t,e){return t.bind((function(t){return e.filter(u(n.eq,t))}))},Ue=function(n,t,e){return 0<e.length?function(n,t,e,r){var o=t(n,e);return N(r,(function(e,r){var o=t(n,r);return Ve(n,e,o)}),o)}(n,t,(r=e)[0],r.slice(1)):h.none();var r},Ke=function(n,t,e,o){void 0===o&&(o=s);var i=[t].concat(n.up().all(t)),c=[e].concat(n.up().all(e)),a=function(n){return j(n,o).fold((function(){return n}),(function(t){return n.slice(0,t+1)}))},l=a(i),f=a(c),d=W(l,(function(t){return P(f,(e=t,u(n.eq,e)));var e}));return{firstpath:r(l),secondpath:r(f),shared:r(d)}},$e=qe(),Xe=function(n,t){return Ue($e,(function(t,e){return n(e)}),t)},Ge=function(n){return Ht(n,"table")},Ye=function(n,t,e){var r=function(n){return function(t){return void 0!==e&&e(t)||Qn(t,n)}};return Qn(n,t)?h.some({boxes:h.some([n]),start:n,finish:t}):Ge(n).bind((function(o){return Ge(t).bind((function(u){if(Qn(o,u))return h.some({boxes:(l=n,f=t,s=Le(o),je(s,l,f)),start:n,finish:t});if(Zn(o,u)){var i=0<(c=Wt(t,"td,th",r(o))).length?c[c.length-1]:t;return h.some({boxes:Fe(o,n,o,t,u),start:n,finish:i})}if(Zn(u,o)){var c,a=0<(c=Wt(n,"td,th",r(u))).length?c[c.length-1]:n;return h.some({boxes:Fe(u,n,o,t,u),start:n,finish:a})}return Ke($e,n,t,undefined).shared().bind((function(i){return Ut(i,"table",e).bind((function(e){var i=Wt(t,"td,th",r(e)),c=0<i.length?i[i.length-1]:t,a=Wt(n,"td,th",r(e)),l=0<a.length?a[a.length-1]:n;return h.some({boxes:Fe(e,n,o,t,u),start:l,finish:c})}))}));var l,f,s}))}))},Je=function(n,t){var e=zt(n,t);return 0<e.length?h.some(e):h.none()},Qe=function(n,t,e){return Vt(n,t).bind((function(t){return Vt(n,e).bind((function(n){return Xe(Ge,[t,n]).map((function(e){return{first:r(t),last:r(n),table:r(e)}}))}))}))},Ze=function(n,t,e,r,o){return u=o,W(n,(function(n){return Yn(n,u)})).bind((function(n){return function(n,t,e){return re(n).bind((function(r){var o,u,i,c=Le(r);return u=t,i=e,de(o=c,n,Qn).bind((function(n){var t=0<u?n.row()+n.rowspan()-1:n.row(),e=0<i?n.column()+n.colspan()-1:n.column();return se(o,t+u,e+i).map((function(n){return n.element()}))}))}))}(n,t,e).bind((function(n){return e=r,Ht(t=n,"table").bind((function(n){return Vt(n,e).bind((function(n){return Ye(n,t).bind((function(n){return n.boxes.map((function(t){return{boxes:t,start:n.start,finish:n.finish}}))}))}))}));var t,e}))}));var u},nr=function(n,t,e){return Qe(n,t,e).bind((function(t){var e=function(t){return Qn(n,t)},r=Ht(t.first(),"thead,tfoot,tbody,table",e),o=Ht(t.last(),"thead,tfoot,tbody,table",e);return r.bind((function(n){return o.bind((function(e){return Qn(n,e)?(r=t.table(),o=t.first(),i=t.last(),function(n,t,e){return We(n,t,e).bind((function(t){return function(n,t){for(var e=!0,r=u(_e,t),o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)e=e&&se(n,o,i).exists(r);return e?h.some(t):h.none()}(n,t)}))}(Le(r),o,i)):h.none();var r,o,i}))}))}))},tr="data-mce-selected",er="td[data-mce-selected],th[data-mce-selected]",rr="[data-mce-selected]",or="data-mce-first-selected",ur="td[data-mce-first-selected],th[data-mce-first-selected]",ir="data-mce-last-selected",cr="td[data-mce-last-selected],th[data-mce-last-selected]",ar=Object.freeze({__proto__:null,selected:tr,selectedSelector:er,attributeSelector:rr,firstSelected:or,firstSelectedSelector:ur,lastSelected:ir,lastSelectedSelector:cr}),lr=function(t){if(!C(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],r={};return M(t,(function(o,u){var i=V(o);if(1!==i.length)throw new Error("one and only one name per case");var c=i[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!C(a))throw new Error("case arguments must be an array");e.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),i=0;i<o.length;i++)o[i]=arguments[i];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[u].apply(null,o)},match:function(n){var t=V(n);if(e.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+t.join(","));if(!L(e,(function(n){return B(t,n)})))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+e.join(", "));return n[c].apply(null,o)},log:function(t){n.console.log(t,{constructors:e,constructor:c,params:o})}}}})),r},fr=lr([{none:[]},{multiple:["elements"]},{single:["selection"]}]),sr=function(n,t,e,r){return n.fold(t,e,r)},dr=fr.none,mr=fr.multiple,gr=fr.single,pr=function(n,t){return sr(t.get(),r([]),o,r([n]))},hr=function(n){return{element:r(n),mergable:h.none,unmergable:h.none,selection:r([n])}},vr=function(n,t,e){return{element:r(e),mergable:r((u=t,sr(n.get(),h.none,(function(n,t){return 0===n.length?h.none():nr(u,ur,cr).bind((function(t){return 1<n.length?h.some({bounds:r(t),cells:r(n)}):h.none()}))}),h.none))),unmergable:r(0<(o=pr(e,n)).length&&L(o,(function(n){return sn(n,"rowspan")&&1<parseInt(ln(n,"rowspan"),10)||sn(n,"colspan")&&1<parseInt(ln(n,"colspan"),10)}))?h.some(o):h.none()),selection:r(pr(e,n))};var o,u},br=function(n,t){return{left:r(n),top:r(t),translate:function(e,r){return br(n+e,t+r)}}},wr=br,yr=function(n,t){return void 0!==n?n:void 0!==t?t:0},Cr=function(n){var t=n.dom().ownerDocument,e=t.body,r=t.defaultView,o=t.documentElement;if(e===n.dom())return wr(e.offsetLeft,e.offsetTop);var u=yr(r.pageYOffset,o.scrollTop),i=yr(r.pageXOffset,o.scrollLeft),c=yr(o.clientTop,e.clientTop),a=yr(o.clientLeft,e.clientLeft);return xr(n).translate(i-a,u-c)},xr=function(n){var t,e=n.dom(),r=e.ownerDocument.body;return r===e?wr(r.offsetLeft,r.offsetTop):mt(n)?(t=e.getBoundingClientRect(),wr(t.left,t.top)):wr(0,0)},Sr=function(n){var t=h.from(n.dom().documentElement).map(Cn.fromDom).getOr(n);return{parent:r(t),view:r(n),origin:r(wr(0,0))}};function Tr(n,t){var e=function(e){var r=t(e);if(r<=0||null===r){var o=bt(e,n);return parseFloat(o)||0}return r},r=function(n,t){return _(t,(function(t,e){var r=bt(n,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,e){if(!R(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var r=t.dom();wn(r)&&(r.style[n]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(n,t,e){var o=r(n,e);return o<t?t-o:0}}}var Rr=Tr("height",(function(n){var t=n.dom();return mt(n)?t.getBoundingClientRect().height:t.offsetHeight})),Or=function(n){return Rr.get(n)},Dr=function(n){return Rr.getOuter(n)},Ar=Tr("width",(function(n){return n.dom().offsetWidth})),Br=function(n){return Ar.get(n)},Pr=function(n){return Ar.getOuter(n)},Er=function(n,t){return{row:n,y:t}},Ir=function(n,t){return{col:n,x:t}},Mr=function(n){return Cr(n).left()+Pr(n)},kr=function(n){return Cr(n).left()},Nr=function(n,t){return Ir(n,kr(t))},_r=function(n,t){return Ir(n,Mr(t))},Wr=function(n){return Cr(n).top()},jr=function(n,t){return Er(n,Wr(t))},zr=function(n,t){return Er(n,Wr(t)+Dr(t))},Fr=function(n,t,e){if(0===e.length)return[];var r=I(e.slice(1),(function(t,e){return t.map((function(t){return n(e,t)}))})),o=e[e.length-1].map((function(n){return t(e.length-1,n)}));return r.concat([o])},Lr={delta:o,positions:function(n){return Fr(jr,zr,n)},edge:Wr},Hr={delta:o,edge:kr,positions:function(n){return Fr(Nr,_r,n)}},qr={delta:function(n){return-n},edge:Mr,positions:function(n){return Fr(_r,Nr,n)}},Vr=function(n){var t=n.grid,e=E(t.columns(),o),u=E(t.rows(),o);return I(e,(function(t){return Ur((function(){return F(u,(function(e){return se(n,e,t).filter((function(n){return n.column()===t})).fold(r([]),(function(n){return[n]}))}))}),(function(n){return 1===n.colspan()}),(function(){return se(n,0,t)}))}))},Ur=function(n,t,e){var r=n();return W(r,t).orThunk((function(){return h.from(r[0]).orThunk(e)})).map((function(n){return n.element()}))},Kr=function(n){var t=n.grid,e=E(t.rows(),o),u=E(t.columns(),o);return I(e,(function(t){return Ur((function(){return F(u,(function(e){return se(n,t,e).filter((function(n){return n.row()===t})).fold(r([]),(function(n){return[n]}))}))}),(function(n){return 1===n.rowspan()}),(function(){return se(n,t,0)}))}))},$r=function(n,t){if(t<0||t>=n.length-1)return h.none();var e=n[t].fold((function(){var e,r,o=(e=n.slice(0,t),(r=O.call(e,0)).reverse(),r);return q(o,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return h.some({value:n,delta:0})})),r=n[t+1].fold((function(){var e=n.slice(t+1);return q(e,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return h.some({value:n,delta:1})}));return e.bind((function(n){return r.map((function(t){var e=t.delta+n.delta;return Math.abs(t.value-n.value)/e}))}))},Xr=function(){var n=Gn().browser;return n.isIE()||n.isEdge()},Gr=function(n,t,e){return r=bt(n,t),o=e,u=parseFloat(r),isNaN(u)?o:u;var r,o,u},Yr=function(n){return Xr()?(e=(t=n).dom().getBoundingClientRect().width,"border-box"===bt(t,"box-sizing")?e:e-Gr(t,"padding-left",0)-Gr(t,"padding-right",0)-(Gr(t,"border-left-width",0)+Gr(t,"border-right-width",0))):Gr(n,"width",Br(n));var t,e},Jr=/(\d+(\.\d+)?)(\w|%)*/,Qr=/(\d+(\.\d+)?)%/,Zr=/(\d+(\.\d+)?)px|em/,no=function(n,t){ht(n,"width",t+"px")},to=function(n,t){ht(n,"width",t+"%")},eo=function(n,t){ht(n,"height",t+"px")},ro=function(n){var t,e=yt(t=n,"height").getOrThunk((function(){return function(n){return Xr()?(e=(t=n).dom().getBoundingClientRect().height,"border-box"===bt(t,"box-sizing")?e:e-Gr(t,"padding-top",0)-Gr(t,"padding-bottom",0)-(Gr(t,"border-top-width",0)+Gr(t,"border-bottom-width",0))):Gr(n,"height",Or(n));var t,e}(t)+"px"}));return e?function(n,t,e,r){var o,u,i,c,a,l=parseInt(n,10);return hn(n,"%")&&"table"!==J(t)?(u=l,i=e,c=r,a=re(o=t).map((function(n){var t=i(n);return Math.floor(u/100*t)})).getOr(u),c(o,a),a):l}(e,n,Or,eo):Or(n)},oo=function(n){return yt(n,"width").fold((function(){return h.from(ln(n,"width"))}),(function(n){return h.some(n)}))},uo=function(n,t){return n/t.pixelWidth()*100},io=function(n,t){return oo(n).fold((function(){var e=Br(n);return uo(e,t)}),(function(e){return function(n,t,e){var r=Qr.exec(t);if(null!==r)return parseFloat(r[1]);var o=Yr(n);return uo(o,e)}(n,e,t)}))},co=function(n,t){return oo(n).fold((function(){return Yr(n)}),(function(e){return function(n,t,e){var r=Zr.exec(t);if(null!==r)return parseInt(r[1],10);var o=Qr.exec(t);return null===o?Yr(n):parseFloat(o[1])/100*e.pixelWidth()}(n,e,t)}))},ao=function(n){return"rowspan",ro(t=n)/$t(t,"rowspan");var t},lo=function(n,t,e){ht(n,"width",t+e)},fo=function(n){return function(n,t){var e,r=(e=n,h.from(e.dom().offsetParent).map(Cn.fromDom).getOr(gt(tt(n))));return t(n)/t(r)*100}(n,Br)+"%"},so=r(Qr),mo=r(Zr),go=function(n,t,e){return yt(n,t).fold((function(){return e(n)+"px"}),(function(n){return n}))},po=function(n,t){return go(n,"width",(function(n){return co(n,t)}))},ho=function(n){return go(n,"height",ao)},vo=function(n,t,e,r,o){var u=Vr(n),i=I(u,(function(n){return n.map(t.edge)}));return I(u,(function(n,t){return n.filter(f(Xt)).fold((function(){var n=$r(i,t);return r(n)}),(function(n){return e(n,o)}))}))},bo=function(n){return n.map((function(n){return n+"px"})).getOr("")},wo=function(n,t,e){return vo(n,t,io,(function(n){return n.fold((function(){return e.minCellWidth()}),(function(n){return n/e.pixelWidth()*100}))}),e)},yo=function(n,t,e){return vo(n,t,co,(function(n){return n.getOrThunk(e.minCellWidth)}),e)},Co=function(n,t,e,r){var o=Kr(n),u=I(o,(function(n){return n.map(t.edge)}));return I(o,(function(n,t){return n.filter(f(Gt)).fold((function(){var n=$r(u,t);return r(n)}),(function(n){return e(n)}))}))},xo=lr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),So=function(n,t,e){var r=e.substring(0,e.length-n.length),o=parseFloat(r);return r===o.toString()?t(o):xo.invalid(e)},To=xn(xn({},xo),{from:function(n){return hn(n,"%")?So("%",xo.percent,n):hn(n,"px")?So("px",xo.pixels,n):xo.invalid(n)}}),Ro=function(n,t,e){var o,u,i,c=To.from(e),a=L(n,(function(n){return"0px"===n}))?(o=c,u=n.length,i=o.fold((function(){return r("")}),(function(n){return r(n/u+"px")}),(function(n){return r(n/u+"px")})),E(u,i)):function(n,t,e){return n.fold((function(){return t}),(function(n){return o=(r=n)/e,I(t,(function(n){return To.from(n).fold((function(){return n}),(function(n){return n*o+"px"}),(function(n){return n/100*r+"px"}))}));var r,o}),(function(n){return r=e,I(t,(function(n){return To.from(n).fold((function(){return n}),(function(n){return n/r*100+"%"}),(function(n){return n+"%"}))}));var r}))}(c,n,t);return Do(a)},Oo=function(n,t){return 0===n.length?t:N(n,(function(n,t){return To.from(t).fold(r(0),o,o)+n}),0)},Do=function(n){if(0===n.length)return n;var t,e,o=N(n,(function(n,t){var e=To.from(t).fold((function(){return{value:t,remainder:0}}),(function(n){return t=n,"px",{value:(e=Math.floor(t))+"px",remainder:t-e};var t,e}),(function(n){return{value:n+"%",remainder:0}}));return{output:[e.value].concat(n.output),remainder:n.remainder+e.remainder}}),{output:[],remainder:0}),u=o.output;return u.slice(0,u.length-1).concat([(t=u[u.length-1],e=Math.round(o.remainder),To.from(t).fold(r(t),(function(n){return n+e+"px"}),(function(n){return n+e+"%"})))])},Ao=To.from,Bo=function(n){return Ao(n).fold(r("px"),r("px"),r("%"))},Po=function(n,t,e,r,o){var u=le(n),i=u.all,c=ge(u);t.each((function(t){var e,i,a=Bo(t),l=Br(n),f=vo(u,r,po,bo,o),s=Ro(f,l,t);e=s,i=a,M(c,(function(n){var t=e.slice(n.column(),n.colspan()+n.column()),r=Oo(t,Jt());ht(n.element(),"width",r+i)})),ht(n,"width",t)})),e.each((function(t){var e,r,o,a=Bo(t),l=Or(n),f=Co(u,Lr,ho,bo),s=Ro(f,l,t);e=s,r=i,o=a,M(c,(function(n){var t=e.slice(n.row(),n.rowspan()+n.row()),r=Oo(t,Qt());ht(n.element(),"height",r+o)})),M(r,(function(n,t){ht(n.element(),"height",e[t])})),ht(n,"height",t)}))},Eo=function(n){return oo(n).exists((function(n){return Qr.test(n)}))},Io=function(n){return oo(n).exists((function(n){return Zr.test(n)}))},Mo=fo,ko={ltr:Hr,rtl:qr},No=function(n){var t=function(t){return n(t).isRtl()?ko.rtl:ko.ltr};return{delta:function(n,e){return t(e).delta(n,e)},edge:function(n){return t(n).edge(n)},positions:function(n,e){return t(e).positions(n,e)}}},_o=function(n){var t=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(n.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+t.length+" arguments");var o={};return M(n,(function(n,e){o[n]=r(t[e])})),o}}.apply(null,n),e=[];return{bind:function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");e.push(n)},unbind:function(n){e=k(e,(function(t){return t!==n}))},trigger:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.apply(null,n);M(e,(function(n){n(o)}))}}},Wo=function(n){return{registry:$(n,(function(n){return{bind:n.bind,unbind:n.unbind}})),trigger:$(n,(function(n){return n.trigger}))}},jo=lr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),zo=xn({},jo),Fo=function(n,t,e){for(var r=0,o=n;o<t;o++)r+=void 0!==e[o]?e[o]:0;return r},Lo=function(n,t){var e=ge(n);return I(e,(function(n){var e=Fo(n.column(),n.column()+n.colspan(),t);return{element:n.element(),width:e,colspan:n.colspan()}}))},Ho=function(n){var t,e,o,u,i,c=Cn.fromDom(function(n){if(lt()&&S(n.target)){var t=Cn.fromDom(n.target);if(tn(t)&&dt(Cn.fromDom(n.target))&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return 0===(r=e).length?h.none():h.some(r[0])}}var r;return h.from(n.target)}(n).getOr(n.target)),a=function(){return n.stopPropagation()},l=function(){return n.preventDefault()},f=(t=l,e=a,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))});return o=c,u=n.clientX,i=n.clientY,{target:r(o),x:r(u),y:r(i),stop:a,prevent:l,kill:f,raw:r(n)}},qo=function(n,t,e,r){n.dom().removeEventListener(t,e,r)},Vo=r(!0),Uo=function(n,t,e){return function(n,t,e,r,o){var i,c,a=(i=e,c=r,function(n){i(n)&&c(Ho(n))});return n.dom().addEventListener(t,a,o),{unbind:u(qo,n,t,a,o)}}(n,t,Vo,e,!1)},Ko=Ho,$o=function(n,t){var e=ln(n,t);return void 0===e||""===e?[]:e.split(" ")},Xo=function(n){return void 0!==n.dom().classList},Go=function(n,t){Xo(n)?n.dom().classList.add(t):function(n,t){return r=t,o=$o(e=n,"class").concat([r]),cn(e,"class",o.join(" ")),!0;var e,r,o}(n,t)},Yo=function(n,t){return Xo(n)&&n.dom().classList.contains(t)},Jo=function(n){var t=n.replace(/\./g,"-");return{resolve:function(n){return t+"-"+n}}},Qo=Jo("ephox-dragster").resolve,Zo=function(n){return n.slice(0).sort()},nu=function(n,t){var e=k(t,(function(t){return!B(n,t)}));0<e.length&&function(n){throw new Error("Unsupported keys for object: "+Zo(n).join(", "))}(e)},tu=function(n){return function(n,t,e){if(0===t.length)throw new Error("You must specify at least one required field.");var r;return function(n,t){if(!C(t))throw new Error("The "+n+" fields must be an array. Was: "+t+".");M(t,(function(t){if(!w(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")}))}("required",t),r=Zo(t),W(r,(function(n,t){return t<r.length-1&&n===r[t+1]})).each((function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})),function(r){var o=V(r);L(t,(function(n){return B(o,n)}))||function(n,t){throw new Error("All required keys ("+Zo(n).join(", ")+") were not specified. Specified keys were: "+Zo(t).join(", ")+".")}(t,o),n(t,o);var u=k(t,(function(n){return!e.validate(r[n],n)}));return 0<u.length&&function(n,t){throw new Error("All values need to be of type: "+t+". Keys ("+Zo(n).join(", ")+") were not.")}(u,e.label),r}}(nu,n,{validate:T,label:"function"})},eu=tu(["compare","extract","mutate","sink"]),ru=tu(["element","start","stop","destroy"]),ou=tu(["forceDrop","drop","move","delayDrop"]),uu=eu({compare:function(n,t){return wr(t.left()-n.left(),t.top()-n.top())},extract:function(n){return h.some(wr(n.x(),n.y()))},sink:function(n,t){var e=function(n){var t=xn({layerClass:Qo("blocker")},n),e=Cn.fromTag("div");return cn(e,"role","presentation"),vt(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Go(e,Qo("blocker")),Go(e,t.layerClass),{element:function(){return e},destroy:function(){Pt(e)}}}(t),r=Uo(e.element(),"mousedown",n.forceDrop),o=Uo(e.element(),"mouseup",n.drop),u=Uo(e.element(),"mousemove",n.move),i=Uo(e.element(),"mouseout",n.delayDrop);return ru({element:e.element,start:function(n){Rt(n,e.element())},stop:function(){Pt(e.element())},destroy:function(){e.destroy(),o.unbind(),u.unbind(),i.unbind(),r.unbind()}})},mutate:function(n,t){n.mutate(t.left(),t.top())}});function iu(){var n={onEvent:e,reset:e},t=function(){var n=h.none(),t=Wo({move:_o(["info"])});return{onEvent:function(e,r){r.extract(e).each((function(e){var o,u,i;(o=r,u=e,i=n.map((function(n){return o.compare(n,u)})),n=h.some(u),i).each((function(n){t.trigger.move(n)}))}))},reset:function(){n=h.none()},events:t.registry}}(),r=n;return{on:function(){r.reset(),r=t},off:function(){r.reset(),r=n},isOn:function(){return r===t},onEvent:function(n,t){r.onEvent(n,t)},events:t.events}}var cu=function(n){return"true"===ln(n,"contenteditable")},au=Jo("ephox-snooker").resolve,lu=au("resizer-bar"),fu=au("resizer-rows"),su=au("resizer-cols"),du=function(n){var t=zt(n.parent(),"."+lu);M(t,Pt)},mu=function(n,t,e){var r=n.origin();M(t,(function(t){t.each((function(t){var o=e(r,t);Go(o,lu),Rt(n.parent(),o)}))}))},gu=function(n,t,e,r){du(n);var o=le(t);!function(n,t,e,r,o,u){var i=Cr(t);!function(n,t,e,r){mu(n,t,(function(n,t){var o,u,i,c,a,l=(o=t.row,u=e.left()-n.left(),i=t.y-n.top(),c=r,a=Cn.fromTag("div"),vt(a,{position:"absolute",left:u+"px",top:i-3.5+"px",height:"7px",width:c+"px"}),an(a,{"data-row":o,role:"presentation"}),a);return Go(l,fu),l}))}(n,0<e.length?o.positions(e,t):[],i,Pr(t)),function(n,t,e,r){mu(n,t,(function(n,t){var o,u,i,c,a,l=(o=t.col,u=t.x-n.left(),i=e.top()-n.top(),c=r,a=Cn.fromTag("div"),vt(a,{position:"absolute",left:u-3.5+"px",top:i+"px",height:c+"px",width:"7px"}),an(a,{"data-column":o,role:"presentation"}),a);return Go(l,su),l}))}(n,0<r.length?u.positions(r,t):[],i,Dr(t))}(n,t,Kr(o),Vr(o),e,r)},pu=function(n,t){var e=zt(n.parent(),"."+lu);M(e,t)},hu=function(n){pu(n,(function(n){ht(n,"display","none")}))},vu=function(n){pu(n,(function(n){ht(n,"display","block")}))},bu=au("resizer-bar-dragging"),wu=function(t,e,r){var o=function(){var n,t=Wo({drag:_o(["xDelta","yDelta","target"])}),e=h.none(),r={mutate:function(t,e){n.trigger.drag(t,e)},events:(n=Wo({drag:_o(["xDelta","yDelta"])})).registry};return r.events.drag.bind((function(n){e.each((function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)}))})),{assign:function(n){e=h.some(n)},get:function(){return e},mutate:r.mutate,events:t.registry}}(),i=function(t,e){return void 0===e&&(e={}),function(t,e,r){var o,u,i=!1,c=Wo({start:_o([]),stop:_o([])}),a=iu(),l=function(){d.stop(),a.isOn()&&(a.off(),c.trigger.stop())},f=(o=l,u=null,{cancel:function(){null!==u&&(n.clearTimeout(u),u=null)},throttle:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];null!==u&&n.clearTimeout(u),u=n.setTimeout((function(){o.apply(null,t),u=null}),200)}});a.events.move.bind((function(n){e.mutate(t,n.info())}));var s=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i&&n.apply(null,t)}},d=e.sink(ou({forceDrop:l,drop:s(l),move:s((function(n){f.cancel(),a.onEvent(n,e)})),delayDrop:s(f.throttle)}),r);return{element:d.element,go:function(n){d.start(n),a.on(),c.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){d.destroy()},events:c.registry}}(t,void 0!==e.mode?e.mode:uu,e)}(o,{}),c=h.none(),a=function(n,t){return h.from(ln(n,t))};o.events.drag.bind((function(n){a(n.target(),"data-row").each((function(t){var e=Yt(n.target(),"top");ht(n.target(),"top",e+n.yDelta()+"px")})),a(n.target(),"data-column").each((function(t){var e=Yt(n.target(),"left");ht(n.target(),"left",e+n.xDelta()+"px")}))}));var l=function(n,t){return Yt(n,t)-Kt(n,"data-initial-"+t,0)};i.events.stop.bind((function(){o.get().each((function(n){c.each((function(o){a(n,"data-row").each((function(t){var e=l(n,"top");dn(n,"data-initial-top"),g.trigger.adjustHeight(o,e,parseInt(t,10))})),a(n,"data-column").each((function(t){var e=l(n,"left");dn(n,"data-initial-left"),g.trigger.adjustWidth(o,e,parseInt(t,10))})),gu(t,o,r,e)}))}))}));var f=function(n,e){g.trigger.startAdjust(),o.assign(n),cn(n,"data-initial-"+e,Yt(n,e)),Go(n,bu),ht(n,"opacity","0.2"),i.go(t.parent())},s=Uo(t.parent(),"mousedown",(function(n){var t,e;t=n.target(),Yo(t,fu)&&f(n.target(),"top"),e=n.target(),Yo(e,su)&&f(n.target(),"left")})),d=function(n){return Qn(n,t.view())},m=Uo(t.view(),"mouseover",(function(n){(function(n){return Ut(n,"table",d).filter((function(n){return Ut(n,"[contenteditable]",d).exists(cu)}))})(n.target()).fold((function(){mt(n.target())&&du(t)}),(function(n){c=h.some(n),gu(t,n,r,e)}))})),g=Wo({adjustHeight:_o(["table","delta","row"]),adjustWidth:_o(["table","delta","column"]),startAdjust:_o([])});return{destroy:function(){s.unbind(),m.unbind(),i.destroy(),du(t)},refresh:function(n){gu(t,n,r,e)},on:i.on,off:i.off,hideBars:u(hu,t),showBars:u(vu,t),events:g.registry}},yu=function(n,t,e){var o=Lr,u=wu(n,t,o),i=Wo({beforeResize:_o(["table"]),afterResize:_o(["table"]),startDrag:_o([])});return u.events.adjustHeight.bind((function(n){var t=n.table();i.trigger.beforeResize(t),function(n,t,e,o){var u,i,c,a=le(n),l=Co(a,o,ao,(function(n){return n.getOrThunk(Qt)})),f=I(l,(function(n,r){return e===r?Math.max(t+n,Qt()):n})),s=(u=f,i=ge(a),I(i,(function(n){var t=Fo(n.row(),n.row()+n.rowspan(),u);return{element:n.element,height:r(t),rowspan:n.rowspan}}))),d=(c=f,I(a.all,(function(n,t){return{element:n.element,height:r(c[t])}})));M(d,(function(n){eo(n.element(),n.height())})),M(s,(function(n){eo(n.element(),n.height())}));var m=N(f,(function(n,t){return n+t}),0);eo(n,m)}(t,o.delta(n.delta(),t),n.row(),o),i.trigger.afterResize(t)})),u.events.startAdjust.bind((function(n){i.trigger.startDrag()})),u.events.adjustWidth.bind((function(n){var o=n.table();i.trigger.beforeResize(o);var u,c,a,l,f,s,d,m,g,p,h,v=t.delta(n.delta(),o),b=e(o);u=o,c=v,a=n.column(),l=t,s=(f=b).getCellDelta(c),d=le(u),g=function(n,t,e,o){var u,i,c=n.slice(0),a=(i=t,0===(u=n).length?zo.none():1===u.length?zo.only(0):0===i?zo.left(0,1):i===u.length-1?zo.right(i-1,i):0<i&&i<u.length-1?zo.middle(i-1,i,i+1):zo.none()),l=function(n){return I(n,r(0))},f=r(l(c)),s=function(n,t){if(0<=e){var r=Math.max(o.minCellWidth(),c[t]-e);return l(c.slice(0,n)).concat([e,r-c[t]]).concat(l(c.slice(t+1)))}var u=Math.max(o.minCellWidth(),c[n]+e),i=c[n]-u;return l(c.slice(0,n)).concat([u-c[n],i]).concat(l(c.slice(t+1)))},d=s;return a.fold(f,(function(n){return o.singleColumnWidth(c[n],e)}),d,(function(n,t,e){return s(t,e)}),(function(n,t){if(0<=e)return l(c.slice(0,t)).concat([e]);var r=Math.max(o.minCellWidth(),c[t]+e);return l(c.slice(0,t)).concat([r-c[t]])}))}(m=f.getWidths(d,l,f),a,s,f),p=I(g,(function(n,t){return n+m[t]})),h=Lo(d,p),M(h,(function(n){f.setElementWidth(n.element,n.width)})),a===d.grid.columns()-1&&f.adjustTableWidth(s),i.trigger.afterResize(o)})),{on:u.on,off:u.off,hideBars:u.hideBars,showBars:u.showBars,destroy:u.destroy,events:i.registry}},Cu=function(n,t){return n.fire("newrow",{node:t})},xu=function(n,t){return n.fire("newcell",{node:t})},Su={"border-collapse":"collapse",width:"100%"},Tu={border:"1"},Ru=function(n){return n.getParam("table_sizing_mode","auto")},Ou=function(n){return n.getParam("table_responsive_width")},Du=function(n){return n.getParam("table_default_attributes",Tu,"object")},Au=function(n){return n.getParam("table_default_styles",function(n){if(ku(n)){var t=n.getBody().offsetWidth;return xn(xn({},Su),{width:t+"px"})}return Nu(n)?function(n,t){var r,o,u,i,c={};return r=t,i=c,o=function(n,t){i[t]=n},u=e,K(n,(function(n,t){(r(n,t)?o:u)(n,t)})),c}(Su,(function(n,t){return"width"!==t})):Su}(n),"object")},Bu=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},Pu=function(n){return n.getParam("table_row_advtab",!0,"boolean")},Eu=function(n){return n.getParam("table_advtab",!0,"boolean")},Iu=function(n){return n.getParam("table_style_by_css",!1,"boolean")},Mu=function(n){return"relative"===Ru(n)||!0===Ou(n)},ku=function(n){return"fixed"===Ru(n)||!1===Ou(n)},Nu=function(n){return"responsive"===Ru(n)},_u=function(n){var t="section",e=n.getParam("table_header_type",t,"string");return B(["section","cells","sectionCells","auto"],e)?e:t},Wu=function(n){var t=n.getParam("table_clone_elements");return w(t)?h.some(t.split(/[ ,]/)):Array.isArray(t)?h.some(t):h.none()},ju=function(n){return n.nodeName.toLowerCase()},zu=function(n){return Cn.fromDom(n.getBody())},Fu=function(n){return n.getBoundingClientRect().width},Lu=function(n){return n.getBoundingClientRect().height},Hu=function(n){return function(t){return Qn(t,zu(n))}},qu=function(n){return/^\d+(\.\d+)?$/.test(n)?n+"px":n},Vu=function(n){dn(n,"data-mce-style"),M(ee(n),(function(n){return dn(n,"data-mce-style")}))},Uu=function(n,t){var e=n.dom.getStyle(t,"width")||n.dom.getAttrib(t,"width");return h.from(e).filter(bn)},Ku=function(n){return/^(\d+(\.\d+)?)%$/.test(n)},$u={isRtl:r(!1)},Xu={isRtl:r(!0)},Gu=function(n){return"rtl"==("rtl"===bt(n,"direction")?"rtl":"ltr")?Xu:$u},Yu=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},Ju=function(n,t){var e=Yu(parseFloat(n)),r=Yu(Br(t));return{width:e.get,pixelWidth:r.get,getWidths:wo,getCellDelta:function(n){return n/r.get()*100},singleColumnWidth:function(n,t){return[100-n]},minCellWidth:function(){return Jt()/r.get()*100},setElementWidth:to,adjustTableWidth:function(n){var o=e.get(),u=o+n/100*o;to(t,u),e.set(u),r.set(Br(t))},label:"percent"}},Qu=function(n,t){var e=Yu(n),r=e.get;return{width:r,pixelWidth:r,getWidths:yo,getCellDelta:o,singleColumnWidth:function(n,t){return[Math.max(Jt(),n+t)-n]},minCellWidth:Jt,setElementWidth:no,adjustTableWidth:function(n){var o=r()+n;no(t,o),e.set(o)},label:"pixel"}},Zu=function(n){return oo(n).fold((function(){return function(n){var t=function(){return Br(n)},o=r(0);return{width:t,pixelWidth:t,getWidths:yo,getCellDelta:o,singleColumnWidth:r([0]),minCellWidth:o,setElementWidth:e,adjustTableWidth:e,label:"none"}}(n)}),(function(t){return function(n,t){var e=so().exec(t);if(null!==e)return Ju(e[1],n);var r=mo().exec(t);if(null!==r){var o=parseInt(r[1],10);return Qu(o,n)}var u=Br(n);return Qu(u,n)}(n,t)}))},ni=Qu,ti=Ju,ei=function(n,t){if(Mu(n)){var e=Uu(n,t.dom()).filter(Ku).getOrThunk((function(){return Mo(t)}));return ti(e,t)}return ku(n)?ni(Br(t),t):Zu(t)},ri=function(n){dn(n,"width")},oi=function(n,t){var e,r,o,u;r=No(Gu),o=ei(n,t),u=fo(e=t),Po(e,h.some(u),h.none(),r,o),ri(e)},ui=function(n,t){!function(n,t,e){var r=Br(n)+"px";Po(n,h.some(r),h.none(),t,e),ri(n)}(t,No(Gu),ei(n,t))},ii=function(n){Ct(n,"width"),M(ee(n),(function(n){Ct(n,"width"),ri(n)})),ri(n)},ci=function(t){var e,o,u=h.none(),i=h.none(),c=h.none(),a=function(n){return"TABLE"===n.nodeName};return t.on("init",(function(){var e,o,a=No(Gu),l=(e=t).inline?function(n,t){return{parent:r(t),view:r(n),origin:r(wr(0,0))}}(zu(e),function(){var t=Cn.fromTag("div");return vt(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Rt(gt(Cn.fromDom(n.document)),t),t}()):Sr(Cn.fromDom(e.getDoc()));if(c=h.some(l),o=t.getParam("object_resizing",!0),(w(o)?"table"===o:o)&&t.getParam("table_resize_bars",!0,"boolean")){var f=yu(l,a,(function(n){return ei(t,n)}));f.on(),f.events.startDrag.bind((function(n){u=h.some(t.selection.getRng())})),f.events.beforeResize.bind((function(n){var e,r,o,u,i=n.table().dom();e=t,o=Fu(r=i),u=Lu(i),e.fire("ObjectResizeStart",{target:r,width:o,height:u})})),f.events.afterResize.bind((function(n){var e,r,o,i,c=n.table(),a=c.dom();Vu(c),u.each((function(n){t.selection.setRng(n),t.focus()})),e=t,o=Fu(r=a),i=Lu(a),e.fire("ObjectResized",{target:r,width:o,height:i}),t.undoManager.add()})),i=h.some(f)}})),t.on("ObjectResizeStart",(function(n){var r=n.target;if(a(r)){var u=Cn.fromDom(r);!Io(u)&&ku(t)?ui(t,u):!Eo(u)&&Mu(t)&&oi(t,u),e=n.width,o=Uu(t,r).getOr("")}})),t.on("ObjectResized",(function(n){var r=n.target;if(a(r)){var u=Cn.fromDom(r);if(""===o||!Ku(o)&&Nu(t))oi(t,u);else if(Ku(o)){var i=parseFloat(o.replace("%","")),c=n.width*i/e;ht(u,"width",c+"%")}else M(ee(u),(function(n){var t=bt(n,"width");ht(n,"width",t),dn(n,"width")}));Vu(u)}})),t.on("SwitchMode",(function(){i.each((function(n){t.mode.isReadOnly()?n.hideBars():n.showBars()}))})),{lazyResize:function(){return i},lazyWire:function(){return c.getOr(Sr(Cn.fromDom(t.getBody())))},destroy:function(){i.each((function(n){n.destroy()})),c.each((function(n){var e;e=n,t.inline&&Pt(e.parent())}))}}},ai=function(n,t){return{element:r(n),offset:r(t)}},li=function(n,t,e){return n.property().isText(t)&&0===n.property().getText(t).trim().length||n.property().isComment(t)?e(t).bind((function(t){return li(n,t,e).orThunk((function(){return h.some(t)}))})):h.none()},fi=function(n,t){return n.property().isText(t)?n.property().getText(t).length:n.property().children(t).length},si=function(n,t){var e=li(n,t,n.query().prevSibling).getOr(t);if(n.property().isText(e))return ai(e,fi(n,e));var r=n.property().children(e);return 0<r.length?si(n,r[r.length-1]):ai(e,fi(n,e))},di=si,mi=qe(),gi=function(n,t){oo(n).bind((function(n){var t=Jr.exec(n);return null!==t?h.some({width:r(parseFloat(t[1])),unit:r(t[3])}):h.none()})).each((function(e){var r=e.width()/2;lo(n,r,e.unit()),lo(t,r,e.unit())}))},pi=function(n){return le(n).grid},hi=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t},vi=function(n,t,e,r){e===r?dn(n,t):cn(n,t,e)},bi=function(n,t,e){n.cells()[t]=e},wi=function(n,t){return Nt(t,n.section())},yi=function(n,t){var e=n.cells(),r=I(e,t);return Nt(r,n.section())},Ci=function(n,t){return n.cells()[t]},xi=function(n,t){return Ci(n,t).element()},Si=function(n){return n.cells().length},Ti=function(n,t){if(0===n.length)return 0;var e=n[0];return j(n,(function(n){return!t(e.element(),n.element())})).fold((function(){return n.length}),(function(n){return n}))},Ri=function(n,t){var e=I(n,(function(n){return I(n.cells(),(function(){return!1}))}));return I(n,(function(o,u){var i,c;return i=F(o.cells(),(function(o,i){if(!1!==e[u][i])return[];var c,a,l,f,s=function(n,t,e,r){var o,u=n[t].cells().slice(e),i=Ti(u,r),c=(o=e,I(n,(function(n){return Ci(n,o)})).slice(t));return{colspan:i,rowspan:Ti(c,r)}}(n,u,i,t);return function(n,t,r,o){for(var u=n;u<n+r;u++)for(var i=t;i<t+o;i++)e[u][i]=!0}(u,i,s.rowspan,s.colspan),[(c=o.element(),a=s.rowspan,l=s.colspan,f=o.isNew(),{element:r(c),rowspan:r(a),colspan:r(l),isNew:r(f)})]})),c=o.section(),{details:r(i),section:r(c)}}))},Oi=function(n,t,e){for(var r=[],o=0;o<n.grid.rows();o++){for(var u=[],i=0;i<n.grid.columns();i++){var c=se(n,o,i).map((function(n){return kt(n.element(),e)})).getOrThunk((function(){return kt(t.gap(),!0)}));u.push(c)}var a=Nt(u,n.all[o].section());r.push(a)}return r},Di=function(n,t){return function(n,t){return I(n,(function(n){var e,o,u,i,c,a=(e=n.details(),q(e,(function(n){return et(n.element()).map((function(n){var t=et(n).isNone();return kt(n,t)}))})).getOrThunk((function(){return kt(t.row(),!0)})));return o=a.element(),u=n.details(),i=n.section(),c=a.isNew(),{element:r(o),cells:r(u),section:r(i),isNew:r(c)}}))}(Ri(n,Qn),t)},Ai=function(n,t){return q(n.all,(function(n){return W(n.cells(),(function(n){return Qn(t,n.element())}))}))},Bi=function(n,t,e,o,i){return function(c,a,l,f,s,d){var m=le(a);return t(m,l).map((function(t){var e=Oi(m,f,!1),o=n(e,t,Qn,i(f)),u=Di(o.grid(),f);return{grid:r(u),cursor:o.cursor}})).fold((function(){return h.none()}),(function(n){var t=function(n,t){var e=[],r=[],o=H(jt(n,"caption,colgroup")).fold((function(){return u(Tt,n)}),(function(n){return u(St,n)})),i=function(t,u){0<t.length?function(t,u){var i=qt(n,u).getOrThunk((function(){var t=Cn.fromTag(u,tt(n).dom());return"thead"===u?o(t):Rt(n,t),t}));Bt(i);var c=I(t,(function(n){n.isNew()&&e.push(n.element());var t=n.element();return Bt(t),M(n.cells(),(function(n){n.isNew()&&r.push(n.element()),vi(n.element(),"colspan",n.colspan(),1),vi(n.element(),"rowspan",n.rowspan(),1),Rt(t,n.element())})),t}));At(i,c)}(t,u):qt(n,u).each(Pt)},c=[],a=[],l=[];return M(t,(function(n){switch(n.section()){case"thead":c.push(n);break;case"tbody":a.push(n);break;case"tfoot":l.push(n)}})),i(c,"thead"),i(a,"tbody"),i(l,"tfoot"),{newRows:e,newCells:r}}(a,n.grid()),i=h.from(d).getOrThunk((function(){return Zu(a)}));return e(a,n.grid(),s,i),o(a),gu(c,a,Lr,s),h.some({cursor:n.cursor,newRows:r(t.newRows),newCells:r(t.newCells)})}))}},Pi=function(n,t){return te(t.element()).bind((function(t){return Ai(n,t)}))},Ei=function(n,t){var e=I(t.selection(),(function(t){return te(t).bind((function(t){return Ai(n,t)}))})),r=hi(e);return 0<r.length?h.some({cells:r,generators:t.generators,clipboard:t.clipboard}):h.none()},Ii=function(n,t){var e=I(t.selection(),(function(t){return te(t).bind((function(t){return Ai(n,t)}))})),r=hi(e);return 0<r.length?h.some(r):h.none()},Mi=function(n,t,e,r){for(var o=!0,u=0;u<n.length;u++)for(var i=0;i<Si(n[0]);i++){var c=e(xi(n[u],i),t);!0===c&&!1===o?bi(n[u],i,kt(r(),!0)):!0===c&&(o=!1)}return n},ki=function(n){return{is:function(t){return n===t},isValue:d,isError:s,getOr:r(n),getOrThunk:r(n),getOrDie:r(n),or:function(t){return ki(n)},orThunk:function(t){return ki(n)},fold:function(t,e){return e(n)},map:function(t){return ki(t(n))},mapError:function(t){return ki(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOption:function(){return h.some(n)}}},Ni=function(n){return{is:s,isValue:s,isError:d,getOr:o,getOrThunk:function(n){return n()},getOrDie:function(){return t=String(n),function(){throw new Error(t)}();var t},or:function(n){return n},orThunk:function(n){return n()},fold:function(t,e){return t(n)},map:function(t){return Ni(n)},mapError:function(t){return Ni(t(n))},each:e,bind:function(t){return Ni(n)},exists:s,forall:d,toOption:h.none}},_i={value:ki,error:Ni,fromOption:function(n,t){return n.fold((function(){return Ni(t)}),ki)}},Wi=function(n,t){return{rowDelta:0,colDelta:Si(n[0])-Si(t[0])}},ji=function(n,t){return{rowDelta:n.length-t.length,colDelta:0}},zi=function(n,t){return I(n,(function(){return kt(t.cell(),!0)}))},Fi=function(n,t,e){return n.concat(E(t,(function(){return wi(n[n.length-1],zi(n[n.length-1].cells(),e))})))},Li=function(n,t,e){return I(n,(function(n){return wi(n,n.cells().concat(zi(E(t,o),e)))}))},Hi=function(n,t,e){var r=t.colDelta<0?Li:o;return(t.rowDelta<0?Fi:o)(r(n,Math.abs(t.colDelta),e),Math.abs(t.rowDelta),e)},qi=function(n,t,e,r,o){var u,i,c,a;u=t,i=n,c=o,a=r.cell,0<i&&i<u[0].cells().length&&M(u,(function(n){var t=n.cells()[i-1],e=n.cells()[i];c(e.element(),t.element())&&bi(n,i,kt(a(),!0))}));var l=ji(e,t),f=Hi(e,l,r),s=ji(t,f),d=Hi(t,s,r);return I(d,(function(t,e){var r=t.cells().slice(0,n).concat(f[e].cells()).concat(t.cells().slice(n,t.cells().length));return wi(t,r)}))},Vi=function(n,t,e,r,o){!function(n,t,e,r){if(0<t&&t<n.length){var o=n[t-1].cells(),u=(i=e,_(o,(function(n,t){return P(n,(function(n){return i(n.element(),t.element())}))?n:n.concat([t])}),[]));M(u,(function(o){for(var u=h.none(),i=function(t){for(var i=function(i){var c=n[t].cells()[i];e(c.element(),o.element())&&(u.isNone()&&(u=h.some(r())),u.each((function(e){bi(n[t],i,kt(e,!0))})))},c=0;c<Si(n[0]);c++)i(c)},c=t;c<n.length;c++)i(c)}))}var i}(t,n,o,r.cell);var u=Wi(e,t),i=Hi(e,u,r),c=Wi(t,i),a=Hi(t,c,r);return a.slice(0,n).concat(i).concat(a.slice(n,a.length))},Ui=function(n,t,e,r,o){var u=n.slice(0,t),i=n.slice(t),c=yi(n[e],(function(e,u){return 0<t&&t<n.length&&r(xi(n[t-1],u),xi(n[t],u))?Ci(n[t],u):kt(o(e.element(),r),!0)}));return u.concat([c]).concat(i)},Ki=function(n,t,e,r,o){return I(n,(function(n){var u,i,c,a,l,f,s,d=0<t&&t<Si(n)&&r(xi(n,t-1),xi(n,t))?Ci(n,t):kt(o(xi(n,e),r),!0);return i=t,c=d,l=(a=(u=n).cells()).slice(0,i),f=a.slice(i),s=l.concat([c]).concat(f),wi(u,s)}))},$i=function(n,t,e,r){return I(n,(function(n){return yi(n,(function(n){return o=n,P(t,(function(n){return e(o.element(),n.element())}))?kt(r(n.element(),e),!0):n;var o}))}))},Xi=function(n,t,e,r){return void 0!==xi(n[t],e)&&0<t&&r(xi(n[t-1],e),xi(n[t],e))},Gi=function(n,t,e){return 0<t&&e(xi(n,t-1),xi(n,t))},Yi=function(n,t,e,r){var o=F(n,(function(r,o){return Xi(n,o,t,e)||Gi(r,t,e)?[]:[Ci(r,t)]}));return $i(n,o,e,r)},Ji=function(n,t,e,r){var o=n[t],u=F(o.cells(),(function(r,u){return Xi(n,t,u,e)||Gi(o,u,e)?[]:[r]}));return $i(n,u,e,r)},Qi=tu(["cell","row","replace","gap"]),Zi=function(n){var t=Kt(n,"colspan",1),e=Kt(n,"rowspan",1);return{element:r(n),colspan:r(t),rowspan:r(e)}},nc=function(n,t){void 0===t&&(t=Zi),Qi(n);var e=Yu(h.none()),r=function(r){var u=function(e){var r;return r=t(e),n.cell(r)}(r);return e.get().isNone()&&e.set(h.some(u)),o=h.some({item:r,replacement:u}),u},o=h.none();return{getOrInit:function(n,t){return o.fold((function(){return r(n)}),(function(e){return t(n,e.item)?e.replacement:r(n)}))},cursor:e.get}},tc=function(n,t){return function(e){var r=Yu(h.none());Qi(e);var o=[],u=function(u){var i={scope:n},c=e.replace(u,t,i);return o.push({item:u,sub:c}),r.get().isNone()&&r.set(h.some(c)),c};return{replaceOrInit:function(n,t){return e=n,r=t,W(o,(function(n){return r(n.item,e)})).fold((function(){return u(n)}),(function(e){return t(n,e.item)?e.sub:u(n)}));var e,r},cursor:r.get}}},ec=function(n){Qi(n);var t=Yu(h.none());return{combine:function(e){return t.get().isNone()&&t.set(h.some(e)),function(){var t=n.cell({element:r(e),colspan:r(1),rowspan:r(1)});return Ct(t,"width"),Ct(e,"width"),t}},cursor:t.get}},rc=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],oc=qe(),uc=function(n){return t=n,e=oc.property().name(t),B(rc,e);var t,e},ic=function(n){return t=n,e=oc.property().name(t),B(["ol","ul"],e);var t,e},cc=function(n){var t,e=function(n){return"br"===J(n)},r=function(n){return Te(n).bind((function(t){var r=ut(t).map((function(n){return!!uc(n)||!!function(n){return t=n,B(["br","img","hr","input"],oc.property().name(t));var t}(n)&&"img"!==J(n)})).getOr(!1);return et(t).map((function(o){return!0===r||"li"===J(u=o)||Lt(u,ic).isSome()||e(t)||uc(o)&&!Qn(n,o)?[]:[Cn.fromTag("br")];var u}))})).getOr([])},o=0===(t=F(n,(function(n){var t=it(n);return L(t,(function(n){return e(n)||en(n)&&0===ve(n).trim().length}))?[]:t.concat(r(n))}))).length?[Cn.fromTag("br")]:t;Bt(n[0]),At(n[0],o)},ac=function(n){0===ee(n).length&&Pt(n)},lc=function(n,t){return{grid:r(n),cursor:r(t)}},fc=function(n,t,e){return sc(n,t,e).orThunk((function(){return sc(n,0,0)}))},sc=function(n,t,e){return h.from(n[t]).bind((function(n){return h.from(n.cells()[e]).bind((function(n){return h.from(n.element())}))}))},dc=function(n,t,e){return lc(n,sc(n,t,e))},mc=function(n){return _(n,(function(n,t){return P(n,(function(n){return n.row()===t.row()}))?n:n.concat([t])}),[]).sort((function(n,t){return n.row()-t.row()}))},gc=function(n){return _(n,(function(n,t){return P(n,(function(n){return n.column()===t.column()}))?n:n.concat([t])}),[]).sort((function(n,t){return n.column()-t.column()}))},pc=function(n,t,e){var r,o=(r=e,I(n,(function(n){var t=I(ee(n),(function(n){var t=Kt(n,"rowspan",1),e=Kt(n,"colspan",1);return It(n,t,e)}));return Mt(n,t,r.section())}))),u=fe(o);return Oi(u,t,!0)},hc=function(n,t){var e=k(n,t);return 0===e.length?h.some("td"):e.length===n.length?h.some("th"):h.none()},vc=function(n,t,e,r){var o=fe(t),u=r.getWidths(o,e,r),i=Lo(o,u);M(i,(function(n){r.setElementWidth(n.element,n.width)}))},bc=Bi((function(n,t,e,r){var o=t[0].row(),u=t[0].row(),i=mc(t),c=_(i,(function(n,t){return Ui(n,u,o,e,r.getOrInit)}),n);return dc(c,u,t[0].column())}),Ii,e,e,nc),wc=Bi((function(n,t,e,r){var o=mc(t),u=o[o.length-1].row(),i=o[o.length-1].row()+o[o.length-1].rowspan(),c=_(o,(function(n,t){return Ui(n,i,u,e,r.getOrInit)}),n);return dc(c,i,t[0].column())}),Ii,e,e,nc),yc=Bi((function(n,t,e,r){var o=gc(t),u=o[0].column(),i=o[0].column(),c=_(o,(function(n,t){return Ki(n,i,u,e,r.getOrInit)}),n);return dc(c,t[0].row(),i)}),Ii,vc,e,nc),Cc=Bi((function(n,t,e,r){var o=t[t.length-1].column(),u=t[t.length-1].column()+t[t.length-1].colspan(),i=gc(t),c=_(i,(function(n,t){return Ki(n,u,o,e,r.getOrInit)}),n);return dc(c,t[0].row(),u)}),Ii,vc,e,nc),xc=Bi((function(n,t,e,r){var o,u,i,c,a=gc(t),l=(o=n,u=a[0].column(),i=a[a.length-1].column(),c=I(o,(function(n){var t=n.cells().slice(0,u).concat(n.cells().slice(i+1));return Nt(t,n.section())})),k(c,(function(n){return 0<n.cells().length}))),f=fc(l,t[0].row(),t[0].column());return lc(l,f)}),Ii,vc,ac,nc),Sc=Bi((function(n,t,e,r){var o,u,i,c=mc(t),a=(o=n,u=c[0].row(),i=c[c.length-1].row(),o.slice(0,u).concat(o.slice(i+1))),l=fc(a,t[0].row(),t[0].column());return lc(a,l)}),Ii,e,ac,nc),Tc=Bi((function(n,t,e,r){var o=Yi(n,t.column(),e,r.replaceOrInit);return dc(o,t.row(),t.column())}),Pi,e,e,tc("row","th")),Rc=Bi((function(n,t,e,r){var o=Yi(n,t.column(),e,r.replaceOrInit);return dc(o,t.row(),t.column())}),Pi,e,e,tc(null,"td")),Oc=(Bi((function(n,t,e,r){var o=Ji(n,t.row(),e,r.replaceOrInit);return dc(o,t.row(),t.column())}),Pi,e,e,tc("col","th")),Bi((function(n,t,e,r){var o=Ji(n,t.row(),e,r.replaceOrInit);return dc(o,t.row(),t.column())}),Pi,e,e,tc(null,"td")),Bi((function(n,t,e,o){var u=t.cells();cc(u);var i=function(n,t,e){if(0===n.length)return n;for(var r=t.startRow();r<=t.finishRow();r++)for(var o=t.startCol();o<=t.finishCol();o++)bi(n[r],o,kt(e(),!1));return n}(n,t.bounds(),r(u[0]));return lc(i,h.from(u[0]))}),(function(n,t){return t.mergable()}),e,e,ec)),Dc=Bi((function(n,t,e,r){var o=N(t,(function(n,t){return Mi(n,t,e,r.combine(t))}),n);return lc(o,h.from(t[0]))}),(function(n,t){return t.unmergable()}),vc,e,ec),Ac=Bi((function(n,t,e,o){var i,c,a,l,f,s=(i=t.clipboard(),c=t.generators(),a=le(i),Oi(a,c,!0));return function(n,t,e,r,o){return function(n,t,e){if(n.row()>=t.length||n.column()>Si(t[0]))return _i.error("invalid start address out of table bounds, row: "+n.row()+", column: "+n.column());var r=t.slice(n.row()),o=r[0].cells().slice(n.column()),u=Si(e[0]),i=e.length;return _i.value({rowDelta:r.length-i,colDelta:o.length-u})}(n,t,e).map((function(i){var c=Hi(t,i,r);return function(n,t,e,r,o){for(var i,c,a,l,f,s=n.row(),d=n.column(),m=s+e.length,g=d+Si(e[0]),p=s;p<m;p++)for(var h=d;h<g;h++){a=h,f=l=void 0,l=u(o,Ci((i=t)[c=p],a).element()),f=i[c],1<i.length&&1<Si(f)&&(0<a&&l(xi(f,a-1))||a<f.cells().length-1&&l(xi(f,a+1))||0<c&&l(xi(i[c-1],a))||c<i.length-1&&l(xi(i[c+1],a)))&&Mi(t,xi(t[p],h),o,r.cell);var v=xi(e[p-s],h-d),b=r.replace(v);bi(t[p],h,kt(b,!0))}return t}(n,c,e,r,o)}))}((l=t.row(),f=t.column(),{row:r(l),column:r(f)}),n,s,t.generators(),e).fold((function(){return lc(n,h.some(t.element()))}),(function(n){var e=fc(n,t.row(),t.column());return lc(n,e)}))}),(function(n,t){return te(t.element()).bind((function(e){return Ai(n,e).map((function(n){return xn(xn({},n),{generators:t.generators,clipboard:t.clipboard})}))}))}),vc,e,nc),Bc=Bi((function(n,t,e,r){var o=n[t.cells[0].row()],u=t.cells[0].column(),i=pc(t.clipboard(),t.generators(),o),c=qi(u,n,i,t.generators(),e),a=fc(c,t.cells[0].row(),t.cells[0].column());return lc(c,a)}),Ei,e,e,nc),Pc=Bi((function(n,t,e,r){var o=n[t.cells[0].row()],u=t.cells[t.cells.length-1].column()+t.cells[t.cells.length-1].colspan(),i=pc(t.clipboard(),t.generators(),o),c=qi(u,n,i,t.generators(),e),a=fc(c,t.cells[0].row(),t.cells[0].column());return lc(c,a)}),Ei,e,e,nc),Ec=Bi((function(n,t,e,r){var o=n[t.cells[0].row()],u=t.cells[0].row(),i=pc(t.clipboard(),t.generators(),o),c=Vi(u,n,i,t.generators(),e),a=fc(c,t.cells[0].row(),t.cells[0].column());return lc(c,a)}),Ei,e,e,nc),Ic=Bi((function(n,t,e,r){var o=n[t.cells[0].row()],u=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),i=pc(t.clipboard(),t.generators(),o),c=Vi(u,n,i,t.generators(),e),a=fc(c,t.cells[0].row(),t.cells[0].column());return lc(c,a)}),Ei,e,e,nc),Mc=function(n,t){var e=le(n);return Ii(e,t).bind((function(n){var t=n[n.length-1],r=n[0].column(),o=t.column()+t.colspan(),u=z(I(e.all,(function(n){return k(n.cells(),(function(n){return n.column()>=r&&n.column()<o}))})));return hc(u,(function(n){return"th"===J(n.element())}))})).getOr("")},kc=function(n){return ju(n.parentNode)},Nc=function(n,t){var e="thead"===kc(t),r=!P(t.cells,(function(n){return"th"!==ju(n)}));return e||r?h.some({thead:e,ths:r}):h.none()},_c=function(n,t){return"thead"===(e=Nc(0,t).fold((function(){return kc(t)}),(function(n){return"thead"})))?"header":"tfoot"===e?"footer":"body";var e},Wc=function(n,t,e){var r=n.getParent(t,"table"),o=t.parentNode,u=ju(o);if(e!==u){var i=n.select(e,r)[0];if(!i){i=n.create(e);var c=r.firstChild;"thead"===e?H(jt(Cn.fromDom(r),"caption,colgroup")).fold((function(){return r.insertBefore(i,c)}),(function(t){return n.insertAfter(i,t.dom())})):r.appendChild(i)}"tbody"===e&&"thead"===u&&i.firstChild?i.insertBefore(t,i.firstChild):i.appendChild(t),o.hasChildNodes()||n.remove(o)}},jc=function(n,t,e,r){return M(t,(function(t){var o=ju(t)!==e?n.rename(t,e):t;n.setAttrib(o,"scope",r)}))},zc=function(n,t,e){var r,o=n.dom;if("header"===e){var u=_u(n),i="auto"===u?(r=re(Cn.fromDom(t.cells[0])).map((function(n){return oe(n)})).getOr([]),q(r,(function(n){return Nc(0,n.dom())})).map((function(n){return n.thead&&n.ths?"sectionCells":n.thead?"section":"cells"})).getOr("section")):u;jc(o,t.cells,"section"===i?"td":"th","col"),Wc(o,t,"cells"===i?"tbody":"thead")}else jc(o,t.cells,"td",null),Wc(o,t,"footer"===e?"tfoot":"tbody")},Fc=function(n){return{get:function(){var t=zu(n);return Je(t,er).fold((function(){return void 0===n.selection.getStart()?dr():gr(n.selection)}),(function(n){return mr(n)}))}}},Lc=function(n){return function(t){return h.from(t.dom.getParent(t.selection.getStart(),n)).map((function(n){return Cn.fromDom(n)}))}},Hc=Lc("th,td"),qc=Lc("th,td,caption"),Vc=function(n){return Hc(n).map((function(t){return pr(t,Fc(n))})).map((function(n){return I(n,(function(n){return n.dom()}))})).getOr([])},Uc=function(n){var t,e,r,o=Hc(n);return e=o.bind((function(n){return re(n)})).map((function(n){return oe(n)})).map((function(n){return I(n,(function(n){return n.dom()}))})),r=function(t,e){return k(e,(function(e){return P(e.cells,(function(e){return"1"===n.dom.getAttrib(e,tr)||e===t.dom()}))}))},((t=o).isSome()&&e.isSome()?h.some(r(t.getOrDie(),e.getOrDie())):h.none()).getOr([])},Kc={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"}},$c=function(n,t,e,r){return E(n,(function(n){return function(n,t,e,r){for(var o=Cn.fromTag("tr"),u=0;u<n;u++){var i=Cn.fromTag(r<t||u<e?"th":"td");u<e&&cn(i,"scope","row"),r<t&&cn(i,"scope","col"),Rt(i,Cn.fromTag("br")),Rt(o,i)}return o}(t,e,r,n)}))},Xc=function(n,t){n.selection.select(t.dom(),!0),n.selection.collapse(!0)},Gc=function(n,t,e,r,o){var i=Au(n),c={styles:i,attributes:Du(n)},a=function(n,t,e,r,o,u){void 0===u&&(u=Kc);var i=Cn.fromTag("table"),c="cells"!==o;vt(i,u.styles),an(i,u.attributes);var a=Math.min(n,e);if(c&&0<e){var l=Cn.fromTag("thead");Rt(i,l);var f=$c(e,t,"sectionCells"===o?a:0,r);At(l,f)}var s=Cn.fromTag("tbody");Rt(i,s);var d=$c(c?n-a:n,t,c?0:e,r);return At(s,d),i}(e,t,o,r,_u(n),c);cn(a,"data-mce-id","__mce");var l,f,s,d=(l=a,f=Cn.fromTag("div"),s=Cn.fromDom(l.dom().cloneNode(!0)),Rt(f,s),f.dom().innerHTML);return n.insertContent(d),Vt(zu(n),'table[data-mce-id="__mce"]').map((function(t){var e,r,o;return ku(n)?ui(n,t):Nu(n)?ii(t):(Mu(n)||(e=i.width,w(e)&&-1!==e.indexOf("%")))&&oi(n,t),Vu(t),dn(t,"data-mce-id"),r=n,M(zt(t,"tr"),(function(n){Cu(r,n.dom()),M(zt(n,"th,td"),(function(n){xu(r,n.dom())}))})),o=n,Vt(t,"td,th").each(u(Xc,o)),t.dom()})).getOr(null)},Yc=function(n,t,e,r,o){void 0===r&&(r={});var u=function(n){return R(n)&&0<n};if(u(t)&&u(e)){var i=r.headerRows||0,c=r.headerColumns||0;return Gc(n,e,t,c,i)}return console.error(o),null},Jc=function(n){return function(){return n().fold((function(){return[]}),(function(n){return I(n,(function(n){return n.dom()}))}))}},Qc=function(n){return function(t){var e=0<t.length?h.some(I(t,Cn.fromDom)):h.none();n(e)}},Zc=tinymce.util.Tools.resolve("tinymce.util.Tools"),na=function(n,t,e){return function(t,r){for(var o=0;o<r.length;o++){var u=n.getStyle(r[o],e);if(void 0===t&&(t=u),t!==u)return""}return t}(void 0,n.select("td,th",t))},ta=function(n,t,e){e&&n.formatter.apply("align"+e,{},t)},ea=function(n,t){Zc.each("left center right".split(" "),(function(e){n.formatter.remove("align"+e,{},t)}))},ra=function(n,t){return(t||[]).concat(I(n,(function(n){return{text:n.text||n.title,value:n.value}})))},oa=function(n){return function(t){return gn(t,"rgb",0)?n.toHex(t):t}},ua=function(n,t){var e=Cn.fromDom(t);return{borderwidth:yt(e,"border-width").getOr(""),borderstyle:yt(e,"border-style").getOr(""),bordercolor:yt(e,"border-color").map(oa(n)).getOr(""),backgroundcolor:yt(e,"background-color").map(oa(n)).getOr("")}},ia=function(n){var t=n[0],e=n.slice(1);return M(e,(function(n){M(V(t),(function(e){K(n,(function(n,r){var o=t[e];""!==o&&e===r&&o!==n&&(t[e]="")}))}))})),t},ca=function(n){var t=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},aa=function(n,t,e,r){return W(n,(function(n){return e.formatter.matchNode(r,t+n)})).getOr("")},la=u(aa,["left","center","right"],"align"),fa=u(aa,["top","middle","bottom"],"valign"),sa=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],da=function(n){return(0<(t=ra(n.getParam("table_cell_class_list",[],"array"))).length?h.some({name:"class",type:"selectbox",label:"Class",items:t}):h.none()).fold((function(){return sa}),(function(n){return sa.concat(n)}));var t},ma=function(n){return function(t,e){var r=t.dom;return{setAttrib:function(t,o){n&&!o||r.setAttrib(e,t,o)},setStyle:function(t,o){n&&!o||r.setStyle(e,t,o)},setFormat:function(r,o){n&&!o||(""===o?t.formatter.remove(r,{value:null},e,!0):t.formatter.apply(r,{value:o},e))}}}},ga={normal:ma(!1),ifTruthy:ma(!0)},pa=function(n,t,e){var r=e.getData();e.close(),n.undoManager.transact((function(){(function(n,t,e){var r=n.dom,o=1===t.length;M(t,(function(t){var u,i,c,a,l,f,s,d,m,g=e.celltype&&ju(t)!==e.celltype?r.rename(t,e.celltype):t,p=o?ga.normal(n,g):ga.ifTruthy(n,g);i=e,(u=p).setAttrib("scope",i.scope),u.setAttrib("class",i.class),u.setStyle("width",qu(i.width)),u.setStyle("height",qu(i.height)),Bu(n)&&(a=e,(c=p).setFormat("tablecellbackgroundcolor",a.backgroundcolor),c.setFormat("tablecellbordercolor",a.bordercolor),c.setFormat("tablecellborderstyle",a.borderstyle),c.setFormat("tablecellborderwidth",qu(a.borderwidth))),o&&(ea(n,g),l=n,f=g,Zc.each("top middle bottom".split(" "),(function(n){l.formatter.remove("valign"+n,{},f)}))),e.halign&&ta(n,g,e.halign),e.valign&&(s=n,d=g,(m=e.valign)&&s.formatter.apply("valign"+m,{},d))}))})(n,t,r),n.focus()}))},ha=function(n){var t=Vc(n);if(0!==t.length){var e=I(t,(function(t){return r=t,o=Bu(e=n),u=e.dom,xn({width:u.getStyle(r,"width")||u.getAttrib(r,"width"),height:u.getStyle(r,"height")||u.getAttrib(r,"height"),scope:u.getAttrib(r,"scope"),celltype:ju(r),class:u.getAttrib(r,"class",""),halign:la(e,r),valign:fa(e,r)},o?ua(u,r):{});var e,r,o,u})),r=ia(e),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:da(n)},ca("cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:da(n)}]};n.windowManager.open({title:"Cell Properties",size:"normal",body:Bu(n)?o:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:u(pa,n,t)})}},va=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],ba=function(n){return(0<(t=ra(n.getParam("table_row_class_list",[],"array"))).length?h.some({name:"class",type:"selectbox",label:"Class",items:t}):h.none()).fold((function(){return va}),(function(n){return va.concat(n)}));var t},wa=function(n,t,e,r){var o=r.getData();r.close(),n.undoManager.transact((function(){(function(n,t,e,r){var o=1===t.length;M(t,(function(t){r.type!==ju(t.parentNode)&&zc(n,t,r.type);var u,i,c,a,l=o?ga.normal(n,t):ga.ifTruthy(n,t);i=r,(u=l).setAttrib("scope",i.scope),u.setAttrib("class",i.class),u.setStyle("height",qu(i.height)),Pu(n)&&(a=r,(c=l).setStyle("background-color",a.backgroundcolor),c.setStyle("border-color",a.bordercolor),c.setStyle("border-style",a.borderstyle)),r.align!==e.align&&(ea(n,t),ta(n,t,r.align))}))})(n,t,e,o),n.focus()}))},ya=function(n){var t=Uc(n);if(0!==t.length){var e=I(t,(function(t){return r=t,o=Pu(e=n),u=e.dom,xn({height:u.getStyle(r,"height")||u.getAttrib(r,"height"),scope:u.getAttrib(r,"scope"),class:u.getAttrib(r,"class",""),type:_c(0,r),align:la(e,r)},o?ua(u,r):{});var e,r,o,u})),r=ia(e),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:ba(n)},ca("row")]},i={type:"panel",items:[{type:"grid",columns:2,items:ba(n)}]};n.windowManager.open({title:"Row Properties",size:"normal",body:Pu(n)?o:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:u(wa,n,t,r)})}},Ca=tinymce.util.Tools.resolve("tinymce.Env"),xa=function(n,t,e,r){if("TD"===t.tagName||"TH"===t.tagName)w(e)?n.setStyle(t,e,r):n.setStyle(t,e);else if(t.children)for(var o=0;o<t.children.length;o++)xa(n,t.children[o],e,r)},Sa=function(n,t,e){var r,o=n.dom,u=e.getData();e.close(),""===u.class&&delete u.class,n.undoManager.transact((function(){if(!t){var e=parseInt(u.cols,10)||1,i=parseInt(u.rows,10)||1;t=Gc(n,e,i,0,0)}!function(n,t,e){var r,o=n.dom,u={},i={};if(u.class=e.class,i.height=qu(e.height),o.getAttrib(t,"width")&&!Iu(n)?u.width=(r=e.width)?r.replace(/px$/,""):"":i.width=qu(e.width),Iu(n)?(i["border-width"]=qu(e.border),i["border-spacing"]=qu(e.cellspacing)):(u.border=e.border,u.cellpadding=e.cellpadding,u.cellspacing=e.cellspacing),Iu(n)&&t.children)for(var c=0;c<t.children.length;c++)xa(o,t.children[c],{"border-width":qu(e.border),padding:qu(e.cellpadding)}),Eu(n)&&xa(o,t.children[c],{"border-color":e.bordercolor});Eu(n)&&(i["background-color"]=e.backgroundcolor,i["border-color"]=e.bordercolor,i["border-style"]=e.borderstyle),u.style=o.serializeStyle(xn(xn({},Au(n)),i)),o.setAttribs(t,xn(xn({},Du(n)),u))}(n,t,u),(r=o.select("caption",t)[0])&&!u.caption&&o.remove(r),!r&&u.caption&&((r=o.create("caption")).innerHTML=Ca.ie?"Â ":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),""===u.align?ea(n,t):ta(n,t,u.align),n.focus(),n.addVisual()}))},Ta=function(n,t){var e,r,o,i,c,a,l,f,s=n.dom,d=function(n,t){var e,r,o,u,i=Au(n),c=Du(n),a=t?(e=n.dom,{borderstyle:G(i,"border-style").getOr(""),bordercolor:oa(e)(G(i,"border-color").getOr("")),backgroundcolor:oa(e)(G(i,"background-color").getOr(""))}):{};return xn(xn(xn(xn(xn(xn({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),i),c),a),(u=i["border-width"],Iu(n)&&u?{border:u}:G(c,"border").fold((function(){return{}}),(function(n){return{border:n}})))),(r=G(i,"border-spacing").or(G(c,"cellspacing")).fold((function(){return{}}),(function(n){return{cellspacing:n}})),o=G(i,"border-padding").or(G(c,"cellpadding")).fold((function(){return{}}),(function(n){return{cellpadding:n}})),xn(xn({},r),o)))}(n,Eu(n));!1===t?(e=s.getParent(n.selection.getStart(),"table"))?(o=e,i=Eu(r=n),f=r.dom,d=xn({width:f.getStyle(o,"width")||f.getAttrib(o,"width"),height:f.getStyle(o,"height")||f.getAttrib(o,"height"),cellspacing:f.getStyle(o,"border-spacing")||f.getAttrib(o,"cellspacing"),cellpadding:f.getAttrib(o,"cellpadding")||na(r.dom,o,"padding"),border:(c=f,a=o,l=yt(Cn.fromDom(a),"border-width"),Iu(r)&&l.isSome()?l.getOr(""):c.getAttrib(a,"border")||na(r.dom,a,"border-width")||na(r.dom,a,"border")),caption:!!f.select("caption",o)[0],class:f.getAttrib(o,"class",""),align:la(r,o)},i?ua(f,o):{})):Eu(n)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""):(d.cols="1",d.rows="1",Eu(n)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""));var m=ra(n.getParam("table_class_list",[],"array"));0<m.length&&d.class&&(d.class=d.class.replace(/\s*mce\-item\-table\s*/g,""));var g,p,h,v,b={type:"grid",columns:2,items:(g=m,p=t?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],h=n.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],v=0<g.length?[{type:"selectbox",name:"class",label:"Class",items:g}]:[],p.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(h).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(v))},w=Eu(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[b]},ca("table")]}:{type:"panel",items:[b]};n.windowManager.open({title:"Table Properties",size:"normal",body:w,onSubmit:u(Sa,n,e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:d})},Ra=function(n,t,o,i,c){var a=Hu(n),l=function(n){return re(n,a)},s=function(t){return Hc(n).each((function(e){l(e).each((function(r){var u=vr(i,r,e);t(r,u).each((function(t){n.selection.setRng(t),n.focus(),o.clear(r),Vu(r)}))}))}))},d=function(){return Hc(n).map((function(t){return l(t).bind((function(r){return function(n,t,e){var r=le(n);return Ii(r,t).map((function(n){var t=Oi(r,e,!1).slice(n[0].row(),n[n.length-1].row()+n[n.length-1].rowspan()),o=Di(t,e);return I(o,(function(n){var t=De(n.element());return M(n.cells(),(function(n){var e=Ae(n.element());vi(e,"colspan",n.colspan(),1),vi(e,"rowspan",n.rowspan(),1),Rt(t,e)})),t}))}))}(r,vr(i,r,t),Me(e,Cn.fromDom(n.getDoc()),h.none()))}))}))},m=function(){return Hc(n).map((function(n){return l(n).bind((function(t){return function(n,t){var e=le(n);return Ii(e,t).map((function(n){var t=n[n.length-1],r=n[0].column(),o=t.column()+t.colspan();return I(e.all,(function(n){var t=k(n.cells(),(function(n){return n.column()>=r&&n.column()<o})),e=I(t,(function(n){var t,e,u,i,c=Ae(n.element());return u=o-r,i=$t(t=c,e="colspan"),1===u||i<=1?dn(t,e):cn(t,e,Math.min(u,i)),c})),u=Cn.fromTag("tr");return At(u,e),u}))}))}(t,vr(i,t,n))}))}))},g=function(t,e){return e().each((function(e){var u=I(e,(function(n){return Ae(n)}));Hc(n).each((function(e){return l(e).each((function(c){var a,l,f=ke(Cn.fromDom(n.getDoc())),s=(a=u,l=f,{selection:r(pr(e,i)),clipboard:r(a),generators:r(l)});t(c,s).each((function(t){n.selection.setRng(t),n.focus(),o.clear(c)}))}))}))}))};K({mceTableSplitCells:function(){return s(t.unmergeCells)},mceTableMergeCells:function(){return s(t.mergeCells)},mceTableInsertRowBefore:function(){return s(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return s(t.insertRowsAfter)},mceTableInsertColBefore:function(){return s(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return s(t.insertColumnsAfter)},mceTableDeleteCol:function(){return s(t.deleteColumn)},mceTableDeleteRow:function(){return s(t.deleteRow)},mceTableCutCol:function(n){return m().each((function(n){c.setColumns(n),s(t.deleteColumn)}))},mceTableCutRow:function(n){return d().each((function(n){c.setRows(n),s(t.deleteRow)}))},mceTableCopyCol:function(n){return m().each((function(n){return c.setColumns(n)}))},mceTableCopyRow:function(n){return d().each((function(n){return c.setRows(n)}))},mceTablePasteColBefore:function(n){return g(t.pasteColsBefore,c.getColumns)},mceTablePasteColAfter:function(n){return g(t.pasteColsAfter,c.getColumns)},mceTablePasteRowBefore:function(n){return g(t.pasteRowsBefore,c.getRows)},mceTablePasteRowAfter:function(n){return g(t.pasteRowsAfter,c.getRows)},mceTableDelete:function(){return qc(n).each((function(t){re(t,a).filter(f(a)).each((function(t){var e=Cn.fromText("");if(St(t,e),Pt(t),n.dom.isEmpty(n.getBody()))n.setContent(""),n.selection.setCursorLocation();else{var r=n.dom.createRng();r.setStart(e.dom(),0),r.setEnd(e.dom(),0),n.selection.setRng(r),n.nodeChanged()}}))}))},mceTableSizingMode:function(t,e){return r=e,qc(n).each((function(t){Nu(n)||ku(n)||Mu(n)||re(t,a).each((function(t){"relative"!==r||Eo(t)?"fixed"!==r||Io(t)?"responsive"!==r||function(n){return oo(n).isNone()}(t)||ii(t):ui(n,t):oi(n,t),Vu(t)}))}));var r}},(function(t,e){return n.addCommand(e,t)})),K({mceTableCellType:function(e,r){return t.setTableCellType(n,r)},mceTableRowType:function(e,r){return t.setTableRowType(n,r)}},(function(t,e){return n.addCommand(e,t)})),n.addCommand("mceTableColType",(function(n,e){return G(e,"type").each((function(n){return s("th"===n?t.makeColumnHeader:t.unmakeColumnHeader)}))})),K({mceTableProps:u(Ta,n,!1),mceTableRowProps:u(ya,n),mceTableCellProps:u(ha,n)},(function(t,e){return n.addCommand(e,(function(){return t()}))})),n.addCommand("mceInsertTable",(function(t,e){y(e)&&0<V(e).length?Yc(n,e.rows,e.columns,e.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Ta(n,!0)})),n.addCommand("mceTableApplyCellStyle",(function(t,e){if(y(e)){var r=Vc(n);0!==r.length&&K(e,(function(t,e){var o="tablecell"+e.toLowerCase().replace("-","");n.formatter.has(o)&&w(t)&&M(r,(function(e){ga.normal(n,e).setFormat(o,t)}))}))}}))},Oa=lr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Da=xn(xn({},Oa),{none:function(n){return void 0===n&&(n=void 0),Oa.none(n)}}),Aa=function(n,t){return re(n,t).bind((function(t){var e=ee(t);return j(e,(function(t){return Qn(n,t)})).map((function(n){return{index:n,all:e}}))}))},Ba=function(n,t,e,o){return{start:r(n),soffset:r(t),finish:r(e),foffset:r(o)}},Pa=lr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ea={before:Pa.before,on:Pa.on,after:Pa.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(o,o,o)}},Ia=lr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ma={domRange:Ia.domRange,relative:Ia.relative,exact:Ia.exact,exactFromRange:function(n){return Ia.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){var t=n.match({domRange:function(n){return Cn.fromDom(n.startContainer)},relative:function(n,t){return Ea.getStart(n)},exact:function(n,t,e,r){return n}});return Cn.fromDom(t.dom().ownerDocument.defaultView)},range:Ba},ka=function(n,t,e){var r,o,u=n.document.createRange();return r=u,t.fold((function(n){r.setStartBefore(n.dom())}),(function(n,t){r.setStart(n.dom(),t)}),(function(n){r.setStartAfter(n.dom())})),o=u,e.fold((function(n){o.setEndBefore(n.dom())}),(function(n,t){o.setEnd(n.dom(),t)}),(function(n){o.setEndAfter(n.dom())})),u},Na=function(n,t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom(),e),u.setEnd(r.dom(),o),u},_a=function(n){return{left:r(n.left),top:r(n.top),right:r(n.right),bottom:r(n.bottom),width:r(n.width),height:r(n.height)}},Wa=lr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ja=function(n,t,e){return t(Cn.fromDom(e.startContainer),e.startOffset,Cn.fromDom(e.endContainer),e.endOffset)},za=function(n,t){var e,o,u,i=(e=n,t.match({domRange:function(n){return{ltr:r(n),rtl:h.none}},relative:function(n,t){return{ltr:Sn((function(){return ka(e,n,t)})),rtl:Sn((function(){return h.some(ka(e,t,n))}))}},exact:function(n,t,r,o){return{ltr:Sn((function(){return Na(e,n,t,r,o)})),rtl:Sn((function(){return h.some(Na(e,r,o,n,t))}))}}}));return(u=(o=i).ltr()).collapsed?o.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return Wa.rtl(Cn.fromDom(n.endContainer),n.endOffset,Cn.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return ja(0,Wa.ltr,u)})):ja(0,Wa.ltr,u)},Fa=function(n,t){return za(n,t).match({ltr:function(t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom(),e),u.setEnd(r.dom(),o),u},rtl:function(t,e,r,o){var u=n.document.createRange();return u.setStart(r.dom(),o),u.setEnd(t.dom(),e),u}})},La=(Wa.ltr,Wa.rtl,function(n,t,e){return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}),Ha=function(n,t,e,r){return en(t)?function(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var u=o.getClientRects();return q(u,(function(n){return La(n,e,r)?h.some(n):h.none()})).map((function(o){return function(n,t,e,r,o){var u=function(e){var r=n.dom().createRange();return r.setStart(t.dom(),e),r.collapse(!0),r},i=ve(t).length,c=function(n,t,e,r,o){if(0===o)return 0;if(t===r)return o-1;for(var u=r,i=1;i<o;i++){var c=n(i),a=Math.abs(t-c.left);if(e<=c.bottom){if(e<c.top||u<a)return i-1;u=a}}return 0}((function(n){return u(n).getBoundingClientRect()}),e,r,o.right,i);return u(c)}(n,t,e,r,o)}))}(n,t,e,r):(u=t,i=e,c=r,a=(o=n).dom().createRange(),l=it(u),q(l,(function(n){return a.selectNode(n.dom()),La(a.getBoundingClientRect(),i,c)?Ha(o,n,i,c):h.none()})));var o,u,i,c,a,l},qa=function(n,t){return t-n.left<n.right-t},Va=function(n,t,e){var r=n.dom().createRange();return r.selectNode(t.dom()),r.collapse(e),r},Ua=function(n,t,e){var r=n.dom().createRange();r.selectNode(t.dom());var o=r.getBoundingClientRect(),u=qa(o,e);return(!0===u?Se:Te)(t).map((function(t){return Va(n,t,u)}))},Ka=function(n,t,e){var r=t.dom().getBoundingClientRect(),o=qa(r,e);return h.some(Va(n,t,o))},$a=document.caretPositionFromPoint?function(n,t,e){return h.from(n.dom().caretPositionFromPoint(t,e)).bind((function(t){if(null===t.offsetNode)return h.none();var e=n.dom().createRange();return e.setStart(t.offsetNode,t.offset),e.collapse(),h.some(e)}))}:document.caretRangeFromPoint?function(n,t,e){return h.from(n.dom().caretRangeFromPoint(t,e))}:function(n,t,e){return Cn.fromPoint(n,t,e).bind((function(r){var o=function(){return e=n,u=t,(0===it(o=r).length?Ka:Ua)(e,o,u);var e,o,u};return 0===it(r).length?o():function(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var u=o.getBoundingClientRect();return function(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,e)),c=Math.max(u.top,Math.min(u.bottom,r));return Ha(n,t,i,c)}(n,t,Math.max(u.left,Math.min(u.right,e)),Math.max(u.top,Math.min(u.bottom,r)))}(n,r,t,e).orThunk(o)}))},Xa=function(n,t){var e=J(n);return"input"===e?Ea.after(n):B(["br","img"],e)?0===t?Ea.before(n):Ea.after(n):Ea.on(n,t)},Ga=function(n,t){var e=n.fold(Ea.before,Xa,Ea.after),r=t.fold(Ea.before,Xa,Ea.after);return Ma.relative(e,r)},Ya=function(n,t,e,r){var o=Xa(n,t),u=Xa(e,r);return Ma.relative(o,u)},Ja=function(n,t){h.from(n.getSelection()).each((function(n){n.removeAllRanges(),n.addRange(t)}))},Qa=function(n,t,e,r,o){var u=Na(n,t,e,r,o);Ja(n,u)},Za=function(n,t){return za(n,t).match({ltr:function(t,e,r,o){Qa(n,t,e,r,o)},rtl:function(t,e,r,o){var u,i,c,a,l,f=n.getSelection();if(f.setBaseAndExtent)f.setBaseAndExtent(t.dom(),e,r.dom(),o);else if(f.extend)try{i=t,c=e,a=r,l=o,(u=f).collapse(i.dom(),c),u.extend(a.dom(),l)}catch(u){Qa(n,r,o,t,e)}else Qa(n,r,o,t,e)}})},nl=function(n,t,e,r,o){var u=Ya(t,e,r,o);Za(n,u)},tl=function(n,t,e){var r=Ga(t,e);Za(n,r)},el=function(n){var t=Cn.fromDom(n.anchorNode),e=Cn.fromDom(n.focusNode);return function(n,t,e,r){var o,u,i,c,a,l=(u=t,i=e,c=r,(a=tt(o=n).dom().createRange()).setStart(o.dom(),u),a.setEnd(i.dom(),c),a),f=Qn(n,e)&&t===r;return l.collapsed&&!f}(t,n.anchorOffset,e,n.focusOffset)?h.some(Ba(t,n.anchorOffset,e,n.focusOffset)):function(n){if(0<n.rangeCount){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return h.some(Ba(Cn.fromDom(t.startContainer),t.startOffset,Cn.fromDom(e.endContainer),e.endOffset))}return h.none()}(n)},rl=function(n){return t=n,h.from(t.getSelection()).filter((function(n){return 0<n.rangeCount})).bind(el).map((function(n){return Ma.exact(n.start(),n.soffset(),n.finish(),n.foffset())}));var t},ol=tinymce.util.Tools.resolve("tinymce.util.VK"),ul=function(n,t,e,r){return al(n,t,Aa(o=e,undefined).fold((function(){return Da.none(o)}),(function(n){return n.index+1<n.all.length?Da.middle(o,n.all[n.index+1]):Da.last(o)})),r);var o},il=function(n,t,e,r){return al(n,t,Aa(o=e,undefined).fold((function(){return Da.none()}),(function(n){return 0<=n.index-1?Da.middle(o,n.all[n.index-1]):Da.first(o)})),r);var o},cl=function(n,t){return function(n){var t=Ma.getWin(n).dom(),e=function(n,e,r,o){return Na(t,n,e,r,o)},r=n.match({domRange:function(n){var t=Cn.fromDom(n.startContainer),e=Cn.fromDom(n.endContainer);return Ya(t,n.startOffset,e,n.endOffset)},relative:Ga,exact:Ya});return za(t,r).match({ltr:e,rtl:e})}(Ma.exact(t,0,t,0))},al=function(n,t,e,r,o){return e.fold(h.none,h.none,(function(n,t){return Se(t).map((function(n){return cl(0,n)}))}),(function(e){return re(e,t).bind((function(t){var o,u=hr(e);return n.undoManager.transact((function(){r.insertRowsAfter(t,u)})),o=zt(t,"tr"),H(o).bind((function(n){return Vt(n,"td,th").map((function(n){return cl(0,n)}))}))}))}))},ll=["table","li","dl"],fl=function(n,t,e,r){if(n.keyCode===ol.TAB){var o=zu(t),u=function(n){var t=J(n);return Qn(n,o)||B(ll,t)},i=t.selection.getRng();if(i.collapsed){var c=Cn.fromDom(i.startContainer);te(c,u).each((function(o){n.preventDefault(),(n.shiftKey?il:ul)(t,u,o,e,r).each((function(n){t.selection.setRng(n)}))}))}}},sl=function(n,t){return{selection:r(n),kill:r(t)}},dl=function(n,t,e,o){return{start:r(Ea.on(n,t)),finish:r(Ea.on(e,o))}},ml=function(n,t){var e=Fa(n,t);return Ba(Cn.fromDom(e.startContainer),e.startOffset,Cn.fromDom(e.endContainer),e.endOffset)},gl=dl,pl=function(n,t,e,r,o){return Qn(e,r)?h.none():Ye(e,r,t).bind((function(t){var r=t.boxes.getOr([]);return 0<r.length?(o(n,r,t.start,t.finish),h.some(sl(h.some(gl(e,0,e,ye(e))),!0))):h.none()}))},hl=function(n,t){return{item:r(n),mode:r(t)}},vl=function(n,t,e,r){return void 0===r&&(r=bl),n.property().parent(t).map((function(n){return hl(n,r)}))},bl=function(n,t,e,r){return void 0===r&&(r=wl),e.sibling(n,t).map((function(n){return hl(n,r)}))},wl=function(n,t,e,r){void 0===r&&(r=wl);var o=n.property().children(t);return e.first(o).map((function(n){return hl(n,r)}))},yl=[{current:vl,next:bl,fallback:h.none()},{current:bl,next:wl,fallback:h.some(vl)},{current:wl,next:wl,fallback:h.some(bl)}],Cl=function(n,t,e,r,o){return void 0===o&&(o=yl),W(o,(function(n){return n.current===e})).bind((function(e){return e.current(n,t,r,e.next).orThunk((function(){return e.fallback.bind((function(e){return Cl(n,t,e,r)}))}))}))},xl=function(n,t,e,r,o,u){return Cl(n,t,r,o).bind((function(t){return u(t.item())?h.none():e(t.item())?h.some(t.item()):xl(n,t.item(),e,t.mode(),o,u)}))},Sl=function(n){return function(t){return 0===n.property().children(t).length}},Tl=function(n,t,e,r){return xl(n,t,e,bl,{sibling:function(n,t){return n.query().prevSibling(t)},first:function(n){return 0<n.length?h.some(n[n.length-1]):h.none()}},r)},Rl=function(n,t,e,r){return xl(n,t,e,bl,{sibling:function(n,t){return n.query().nextSibling(t)},first:function(n){return 0<n.length?h.some(n[0]):h.none()}},r)},Ol=qe(),Dl=function(n,t){return Tl(e=Ol,n,Sl(e),t);var e},Al=function(n,t){return Rl(e=Ol,n,Sl(e),t);var e},Bl=lr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Pl=function(n){return Ut(n,"tr")},El=xn(xn({},Bl),{verify:function(n,t,e,r,o,u,i){return Ut(r,"td,th",i).bind((function(e){return Ut(t,"td,th",i).map((function(t){return Qn(e,t)?Qn(r,e)&&ye(e)===o?u(t):Bl.none("in same cell"):Xe(Pl,[e,t]).fold((function(){return o=t,i=e,c=(r=n).getRect(o),(a=r.getRect(i)).right>c.left&&a.left<c.right?Bl.success():u(t);var r,o,i,c,a}),(function(n){return u(t)}))}))})).getOr(Bl.none("default"))},cata:function(n,t,e,r,o){return n.fold(t,e,r,o)}}),Il=function(n,t){return j(n,u(Qn,t))},Ml=function(n){return"br"===J(n)},kl=function(n,t,e){return t(n,e).bind((function(n){return en(n)&&0===ve(n).trim().length?kl(n,t,e):h.some(n)}))},Nl=function(n,t,e,o){return ct(u=t,i=e).filter(Ml).orThunk((function(){return ct(u,i-1).filter(Ml)})).bind((function(t){return o.traverse(t).fold((function(){return kl(t,o.gather,n).map(o.relative)}),(function(n){return function(n){return et(n).bind((function(t){var e=it(t);return Il(e,n).map((function(o){return{parent:r(t),children:r(e),element:r(n),index:r(o)}}))}))}(n).map((function(n){return Ea.on(n.parent(),n.index())}))}))}));var u,i},_l=function(n,t){return{left:n.left,top:n.top+t,right:n.right,bottom:n.bottom+t}},Wl=function(n,t){return{left:n.left,top:n.top-t,right:n.right,bottom:n.bottom-t}},jl=function(n,t,e){return{left:n.left+t,top:n.top+e,right:n.right+t,bottom:n.bottom+e}},zl=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},Fl=function(n,t){return h.some(n.getRect(t))},Ll=function(n,t,e){return tn(t)?Fl(n,t).map(zl):en(t)?(r=n,o=t,(0<=(u=e)&&u<ye(o)?r.getRangedRect(o,u,o,u+1):0<u?r.getRangedRect(o,u-1,o,u):h.none()).map(zl)):h.none();var r,o,u},Hl=function(n,t){return tn(t)?Fl(n,t).map(zl):en(t)?n.getRangedRect(t,0,t,ye(t)).map(zl):h.none()},ql=lr([{none:[]},{retry:["caret"]}]),Vl=function(n,t,e){return Ft((function(n,t){return t(n)}),Lt,t,uc,undefined).fold(r(!1),(function(t){return Hl(n,t).exists((function(n){return r=n,(t=e).left<r.left||Math.abs(r.right-t.left)<1||t.left>r.right;var t,r}))}))},Ul={point:function(n){return n.bottom},adjuster:function(n,t,e,r,o){var u=_l(o,5);return Math.abs(e.bottom-r.bottom)<1||e.top>o.bottom?ql.retry(u):e.top===o.bottom?ql.retry(_l(o,1)):Vl(n,t,o)?ql.retry(jl(u,5,0)):ql.none()},move:_l,gather:Al},Kl=function(n,t,e,r,o){return 0===o?h.some(r):(a=n,l=r.left,f=t.point(r),a.elementFromPoint(l,f).filter((function(n){return"table"===J(n)})).isSome()?(i=r,c=o-1,Kl(n,u=t,e,u.move(i,5),c)):n.situsFromPoint(r.left,t.point(r)).bind((function(u){return u.start().fold(h.none,(function(u){return Hl(n,u).bind((function(i){return t.adjuster(n,u,i,e,r).fold(h.none,(function(r){return Kl(n,t,e,r,o-1)}))})).orThunk((function(){return h.some(r)}))}),h.none)})));var u,i,c,a,l,f},$l=function(n,t,e){var r,o,u,i=n.move(e,5),c=Kl(t,n,e,i,100).getOr(i);return o=c,u=t,((r=n).point(o)>u.getInnerHeight()?h.some(r.point(o)-u.getInnerHeight()):r.point(o)<0?h.some(-r.point(o)):h.none()).fold((function(){return t.situsFromPoint(c.left,n.point(c))}),(function(e){return t.scrollBy(0,e),t.situsFromPoint(c.left,n.point(c)-e)}))},Xl={tryUp:u($l,{point:function(n){return n.top},adjuster:function(n,t,e,r,o){var u=Wl(o,5);return Math.abs(e.top-r.top)<1||e.bottom<o.top?ql.retry(u):e.bottom===o.top?ql.retry(Wl(o,1)):Vl(n,t,o)?ql.retry(jl(u,5,0)):ql.none()},move:Wl,gather:Dl}),tryDown:u($l,Ul),ieTryUp:function(n,t){return n.situsFromPoint(t.left,t.top-5)},ieTryDown:function(n,t){return n.situsFromPoint(t.left,t.bottom+5)},getJumpSize:r(5)},Gl=function(n,t,e){return n.getSelection().bind((function(o){return function(n,t,e,o){var u,i,c;return(Ml(t)?(u=n,i=t,(c=o).traverse(i).orThunk((function(){return kl(i,c.gather,u)})).map(c.relative)):Nl(n,t,e,o)).map((function(n){return{start:r(n),finish:r(n)}}))}(t,o.finish(),o.foffset(),e).fold((function(){return h.some(ai(o.finish(),o.foffset()))}),(function(r){var u,i=n.fromSitus(r);return u=El.verify(n,o.finish(),o.foffset(),i.finish(),i.foffset(),e.failure,t),El.cata(u,(function(n){return h.none()}),(function(){return h.none()}),(function(n){return h.some(ai(n,0))}),(function(n){return h.some(ai(n,ye(n)))}))}))}))},Yl=function(n,t,e,r,o,u){return 0===u?h.none():Zl(n,t,e,r,o).bind((function(i){var c=n.fromSitus(i),a=El.verify(n,e,r,c.finish(),c.foffset(),o.failure,t);return El.cata(a,(function(){return h.none()}),(function(){return h.some(i)}),(function(i){return Qn(e,i)&&0===r?Jl(n,e,r,Wl,o):Yl(n,t,i,0,o,u-1)}),(function(i){return Qn(e,i)&&r===ye(i)?Jl(n,e,r,_l,o):Yl(n,t,i,ye(i),o,u-1)}))}))},Jl=function(n,t,e,r,o){return Ll(n,t,e).bind((function(t){return Ql(n,o,r(t,Xl.getJumpSize()))}))},Ql=function(n,t,e){var r=Gn().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(n,e):r.isIE()?t.ieRetry(n,e):h.none()},Zl=function(n,t,e,r,o){return Ll(n,e,r).bind((function(t){return Ql(n,o,t)}))},nf=function(n,t,e,o,u){return Ut(o,"td,th",t).bind((function(o){return Ut(o,"table",t).bind((function(i){return function(n,t){return Lt(n,(function(n){return et(n).exists((function(n){return Qn(n,t)}))}),void 0).isSome()}(u,i)?Gl(c=n,a=t,l=e).bind((function(n){return Yl(c,a,n.element(),n.offset(),l,20).map(c.fromSitus)})).bind((function(n){return Ut(n.finish(),"td,th",t).map((function(t){return{start:r(o),finish:r(t),range:r(n)}}))})):h.none();var c,a,l}))}))},tf=function(n,t,e,r,o,u){return Gn().browser.isIE()?h.none():u(r,t).orThunk((function(){return nf(n,t,e,r,o).map((function(n){var t=n.range();return sl(h.some(gl(t.start(),t.soffset(),t.finish(),t.foffset())),!0)}))}))},ef=function(n,t){return Ut(n,"tr",t).bind((function(n){return Ut(n,"table",t).bind((function(e){var r=zt(e,"tr");return Qn(n,r[0])?Tl(Ol,e,(function(n){return Te(n).isSome()}),t).map((function(n){var t=ye(n);return sl(h.some(gl(n,t,n,t)),!0)})):h.none()}))}))},rf=function(n,t){return Ut(n,"tr",t).bind((function(n){return Ut(n,"table",t).bind((function(e){var r=zt(e,"tr");return Qn(n,r[r.length-1])?Rl(Ol,e,(function(n){return Se(n).isSome()}),t).map((function(n){return sl(h.some(gl(n,0,n,0)),!0)})):h.none()}))}))},of=function(n,t,e,r,o,u,i){return nf(n,e,r,o,u).bind((function(n){return pl(t,e,n.start(),n.finish(),i)}))},uf=function(n,t){return Ut(n,"td,th",t)},cf={traverse:ut,gather:Al,relative:Ea.before,otherRetry:Xl.tryDown,ieRetry:Xl.ieTryDown,failure:El.failedDown},af={traverse:ot,gather:Dl,relative:Ea.before,otherRetry:Xl.tryUp,ieRetry:Xl.ieTryUp,failure:El.failedUp},lf=function(n){return function(t){return t===n}},ff=lf(38),sf=lf(40),df=function(n){return 37<=n&&n<=40},mf={isBackward:lf(37),isForward:lf(39)},gf={isBackward:lf(39),isForward:lf(37)},pf=function(n){return{left:n.left(),top:n.top(),right:n.right(),bottom:n.bottom(),width:n.width(),height:n.height()}},hf=function(t){return{elementFromPoint:function(n,e){return Cn.fromPoint(Cn.fromDom(t.document),n,e)},getRect:function(n){return n.dom().getBoundingClientRect()},getRangedRect:function(n,e,r,o){var u=Ma.exact(n,e,r,o);return function(n,t){var e,r,o;return 0<(o=0<(r=(e=Fa(n,t)).getClientRects()).length?r[0]:e.getBoundingClientRect()).width||0<o.height?h.some(o).map(_a):h.none()}(t,u).map(pf)},getSelection:function(){return rl(t).map((function(n){return ml(t,n)}))},fromSitus:function(n){var e=Ma.relative(n.start(),n.finish());return ml(t,e)},situsFromPoint:function(n,e){return function(n,t,e){return r=t,o=e,u=Cn.fromDom(n.document),$a(u,r,o).map((function(n){return Ba(Cn.fromDom(n.startContainer),n.startOffset,Cn.fromDom(n.endContainer),n.endOffset)}));var r,o,u}(t,n,e).map((function(n){return dl(n.start(),n.soffset(),n.finish(),n.foffset())}))},clearSelection:function(){t.getSelection().removeAllRanges()},collapseSelection:function(n){void 0===n&&(n=!1),rl(t).each((function(e){return e.fold((function(t){return t.collapse(n)}),(function(e,r){var o=n?e:r;tl(t,o,o)}),(function(e,r,o,u){var i=n?e:o,c=n?r:u;nl(t,i,c,i,c)}))}))},setSelection:function(n){nl(t,n.start(),n.soffset(),n.finish(),n.foffset())},setRelativeSelection:function(n,e){tl(t,n,e)},selectContents:function(n){!function(n,t){var e,r,o=(e=t,function(n,t){n.selectNodeContents(t.dom())}(r=n.document.createRange(),e),r);Ja(n,o)}(t,n)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){var e,r,o,u;return(e=Cn.fromDom(t.document),r=void 0!==e?e.dom():n.document,o=r.body.scrollLeft||r.documentElement.scrollLeft,u=r.body.scrollTop||r.documentElement.scrollTop,wr(o,u)).top()},scrollBy:function(e,r){var o,u,i;o=e,u=r,(void 0!==(i=Cn.fromDom(t.document))?i.dom():n.document).defaultView.scrollBy(o,u)}}},vf=function(n,t){return{rows:n,cols:t}},bf=function(n,t,e){var r=function(t){dn(t,n.selected),dn(t,n.firstSelected),dn(t,n.lastSelected)},o=function(t){cn(t,n.selected,"1")},u=function(n){i(n),e()},i=function(t){var e=zt(t,n.selectedSelector);M(e,r)};return{clearBeforeUpdate:i,clear:u,selectRange:function(e,r,i,c){u(e),M(r,o),cn(i,n.firstSelected,"1"),cn(c,n.lastSelected,"1"),t(r,i,c)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}},wf=function(n){return!1===Yo(Cn.fromDom(n.target),"ephox-snooker-resizer-bar")};function yf(n,t,r){var o=bf(ar,(function(t,o,u){r.targets().each((function(r){re(o).each((function(i){var c=Wu(n),a=Me(e,Cn.fromDom(n.getDoc()),c),l=function(n,t,e){var r=le(n);return Ii(r,t).map((function(n){var t,o,u,i,c,a,l,f,s,d=Oi(r,e,!1);return{upOrLeftCells:(t=n,o=e,u=d.slice(0,t[t.length-1].row()+1),i=Di(u,o),F(i,(function(n){var e=n.cells().slice(0,t[t.length-1].column()+1);return I(e,(function(n){return n.element()}))}))),downOrRightCells:(a=n,l=e,f=(c=d).slice(a[0].row()+a[0].rowspan()-1,c.length),s=Di(f,l),F(s,(function(n){var t=n.cells().slice(a[0].column()+a[0].colspan()-1,+n.cells().length);return I(t,(function(n){return n.element()}))})))}}))}(i,r,a);!function(n,t,e,r,o){n.fire("TableSelectionChange",{cells:t,start:e,finish:r,otherCells:o})}(n,t,o,u,l)}))}))}),(function(){return function(n){n.fire("TableSelectionClear")}(n)}));return n.on("init",(function(r){var i=n.getWin(),c=zu(n),a=Hu(n),l=function(n,t,e,r){var o=function(n,t,e,r){var o=h.none(),u=function(){o=h.none()};return{mousedown:function(n){r.clear(t),o=uf(n.target(),e)},mouseover:function(u){o.each((function(o){r.clearBeforeUpdate(t),uf(u.target(),e).each((function(u){Ye(o,u,e).each((function(e){var i=e.boxes.getOr([]);(1<i.length||1===i.length&&!Qn(o,u))&&(r.selectRange(t,i,e.start,e.finish),n.selectContents(u))}))}))}))},mouseup:function(n){o.each(u)}}}(hf(n),t,e,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}}(i,c,a,o),f=function(n,t,e,r){var o=hf(n),i=function(){return r.clear(t),h.none()};return{keydown:function(n,c,a,l,f,s){var d=n.raw(),m=d.which,g=!0===d.shiftKey;return Je(t,r.selectedSelector).fold((function(){return sf(m)&&g?u(of,o,t,e,cf,l,c,r.selectRange):ff(m)&&g?u(of,o,t,e,af,l,c,r.selectRange):sf(m)?u(tf,o,e,cf,l,c,rf):ff(m)?u(tf,o,e,af,l,c,ef):h.none}),(function(n){var e=function(e){return function(){return q(e,(function(e){return o=e.rows,u=e.cols,i=t,Ze(n,o,u,(c=r).firstSelectedSelector,c.lastSelectedSelector).map((function(n){return c.clearBeforeUpdate(i),c.selectRange(i,n.boxes,n.start,n.finish),n.boxes}));var o,u,i,c})).fold((function(){return Qe(t,r.firstSelectedSelector,r.lastSelectedSelector).map((function(n){var e=sf(m)||s.isForward(m)?Ea.after:Ea.before;return o.setRelativeSelection(Ea.on(n.first(),0),e(n.table())),r.clear(t),sl(h.none(),!0)}))}),(function(n){return h.some(sl(h.none(),!0))}))}};return sf(m)&&g?e([vf(1,0)]):ff(m)&&g?e([vf(-1,0)]):s.isBackward(m)&&g?e([vf(0,-1),vf(-1,0)]):s.isForward(m)&&g?e([vf(0,1),vf(1,0)]):df(m)&&0==g?i:h.none}))()},keyup:function(n,o,u,i,c){return Je(t,r.selectedSelector).fold((function(){var a,l,f,s,d,m,g,p=n.raw(),v=p.which;return 0!=(!0===p.shiftKey)&&df(v)?(a=t,l=e,f=o,s=u,d=i,m=c,g=r.selectRange,Qn(f,d)&&s===m?h.none():Ut(f,"td,th",l).bind((function(n){return Ut(d,"td,th",l).bind((function(t){return pl(a,l,n,t,g)}))}))):h.none()}),h.none)}}}(i,c,a,o),s=function(n,t,e,r){var o=hf(n);return function(n,u){r.clearBeforeUpdate(t),Ye(n,u,e).each((function(n){var e=n.boxes.getOr([]);r.selectRange(t,e,n.start,n.finish),o.selectContents(u),o.collapseSelection()}))}}(i,c,a,o);n.on("TableSelectorChange",(function(n){return s(n.start,n.finish)}));var d,m,g=function(t,e){!0===t.raw().shiftKey&&(e.kill()&&t.kill(),e.selection().each((function(t){var e=Ma.relative(t.start(),t.finish()),r=Fa(i,e);n.selection.setRng(r)})))},p=function(n){return 0===n.button},v=(d=Yu(Cn.fromDom(c)),m=Yu(0),{touchEnd:function(n){var t=Cn.fromDom(n.target);if("td"===J(t)||"th"===J(t)){var e=d.get(),r=m.get();Qn(e,t)&&n.timeStamp-r<300&&(n.preventDefault(),s(t,t))}d.set(t),m.set(n.timeStamp)}});n.on("mousedown",(function(n){p(n)&&wf(n)&&l.mousedown(Ko(n))})),n.on("mouseover",(function(n){var t;(void 0===(t=n).buttons||Ca.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&wf(n)&&l.mouseover(Ko(n))})),n.on("mouseup",(function(n){p(n)&&wf(n)&&l.mouseup(Ko(n))})),n.on("touchend",v.touchEnd),n.on("keyup",(function(t){var e=Ko(t);if(e.raw().shiftKey&&df(e.raw().which)){var r=n.selection.getRng(),o=Cn.fromDom(r.startContainer),u=Cn.fromDom(r.endContainer);f.keyup(e,o,r.startOffset,u,r.endOffset).each((function(n){g(e,n)}))}})),n.on("keydown",(function(e){var r=Ko(e);t().each((function(n){return n.hideBars()}));var o=n.selection.getRng(),u=Cn.fromDom(n.selection.getStart()),i=Cn.fromDom(o.startContainer),c=Cn.fromDom(o.endContainer),a=Gu(u).isRtl()?gf:mf;f.keydown(r,i,o.startOffset,c,o.endOffset,a).each((function(n){g(r,n)})),t().each((function(n){return n.showBars()}))})),n.on("NodeChange",(function(){var t=n.selection,r=Cn.fromDom(t.getStart()),u=Cn.fromDom(t.getEnd());Xe(re,[r,u]).fold((function(){return o.clear(c)}),e)}))})),{clear:o.clear}}var Cf={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}};function xf(t){var o=Fc(t),u=function(n,t){var e=Yu(h.none()),r=Yu([]),o=function(){return qc(n).bind((function(n){return re(n).map((function(e){return"caption"===J(n)?hr(n):vr(t,e,n)}))}))},u=function(){e.set(Sn(o)()),M(r.get(),(function(n){return n()}))},i=function(n,t){var o=function(){return e.get().fold((function(){n.setDisabled(!0)}),(function(e){n.setDisabled(t(e))}))};return o(),r.set(r.get().concat([o])),function(){r.set(k(r.get(),(function(n){return n!==o})))}};return n.on("NodeChange ExecCommand TableSelectorChange",u),{onSetupTable:function(n){return i(n,(function(n){return!1}))},onSetupCellOrRow:function(n){return i(n,(function(n){return"caption"===J(n.element())}))},onSetupPasteable:function(n){return function(t){return i(t,(function(t){return"caption"===J(t.element())||n().isNone()}))}},onSetupMergeable:function(n){return i(n,(function(n){return n.mergable().isNone()}))},onSetupUnmergeable:function(n){return i(n,(function(n){return n.unmergable().isNone()}))},resetTargets:u,targets:function(){return e.get()}}}(t,o),i=ci(t),c=yf(t,i.lazyResize,u),a=function(n,t){var r=function(n){return"table"===J(zu(n))},o=Wu(n),u=function(t,e,r,u){return function(i,c){Vu(i);var a=u(),l=Cn.fromDom(n.getDoc()),f=No(Gu),s=Me(r,l,o),d=ei(n,i);return e(i)?t(a,i,c,s,f,d).bind((function(t){return M(t.newRows(),(function(t){Cu(n,t.dom())})),M(t.newCells(),(function(t){xu(n,t.dom())})),t.cursor().map((function(t){var e=di(mi,t),r=n.dom.createRng();return r.setStart(e.element().dom(),e.offset()),r.setEnd(e.element().dom(),e.offset()),r}))})):h.none()}},i=u(Sc,(function(t){return!1===r(n)||1<pi(t).rows()}),e,t),c=u(xc,(function(t){return!1===r(n)||1<pi(t).columns()}),e,t),a=u(bc,d,e,t),l=u(wc,d,e,t),f=u(yc,d,gi,t),s=u(Cc,d,gi,t),m=u(Oc,d,e,t),g=u(Dc,d,e,t),p=u(Bc,d,e,t),v=u(Pc,d,e,t),b=u(Ec,d,e,t),w=u(Ic,d,e,t),y=u(Ac,d,e,t),C=function(n,t){return G(n,"type").filter((function(n){return B(t,n)}))};return{deleteRow:i,deleteColumn:c,insertRowsBefore:a,insertRowsAfter:l,insertColumnsBefore:f,insertColumnsAfter:s,mergeCells:m,unmergeCells:g,pasteColsBefore:p,pasteColsAfter:v,pasteRowsBefore:b,pasteRowsAfter:w,pasteCells:y,setTableCellType:function(n,t){return C(t,["td","th"]).each((function(t){jc(n.dom,Vc(n),t,null)}))},setTableRowType:function(n,t){return C(t,["header","body","footer"]).each((function(t){I(Uc(n),(function(e){return zc(n,e,t)}))}))},makeColumnHeader:u(Tc,d,e,t),unmakeColumnHeader:u(Rc,d,e,t),getTableRowType:function(n){var t=Uc(n);if(0<t.length){var e=I(t,(function(n){return _c(0,n)})),r=B(e,"header"),o=B(e,"footer");if(r||o){var u=B(e,"body");return!r||u||o?r||u||!o?"":"footer":"header"}return"body"}},getTableCellType:function(n){return hc(Vc(n),(function(n){return"th"===ju(n)})).getOr("")},getTableColType:Mc}}(t,i.lazyWire),l=function(){var n=Yu(h.none()),t=Yu(h.none()),e=function(n){n.set(h.none())};return{getRows:n.get,setRows:function(r){n.set(r),e(t)},clearRows:function(){return e(n)},getColumns:t.get,setColumns:function(r){t.set(r),e(n)},clearColumns:function(){return e(t)}}}();return Ra(t,a,c,o,l),function(n,t,e){var r=Hu(n);K({mceTableRowType:function(){return t.getTableRowType(n)},mceTableCellType:function(){return t.getTableCellType(n)},mceTableColType:function(){return Hc(n).bind((function(n){return re(n,r).map((function(r){var o=vr(e,r,n);return t.getTableColType(r,o)}))})).getOr("")}},(function(t,e){return n.addQueryValueHandler(e,t)}))}(t,a,o),function(t,o,u,i){t.on("BeforeGetContent",(function(n){!0===n.selection&&sr(o.get(),e,(function(e){n.preventDefault(),re(e[0]).map(Ae).map((function(n){return[pe(n,rr)]})).each((function(e){var r;n.content="text"===n.format?I(e,(function(n){return n.dom().innerText})).join(""):(r=t,I(e,(function(n){return r.selection.serializer.serialize(n.dom(),{})})).join(""))}))}),e)})),t.on("BeforeSetContent",(function(e){!0===e.selection&&!0===e.paste&&h.from(t.dom.getParent(t.selection.getStart(),"th,td")).each((function(o){var c=Cn.fromDom(o);re(c).each((function(o){var a,l,f,s,d,m=k((a=e.content,(l=n.document.createElement("div")).innerHTML=a,it(Cn.fromDom(l))),(function(n){return"meta"!==J(n)}));if(1===m.length&&(d=m[0],"table"===J(d))){e.preventDefault();var g=Cn.fromDom(t.getDoc()),p=ke(g),h=(f=c,s=m[0],{element:r(f),clipboard:r(s),generators:r(p)});u.pasteCells(o,h).each((function(n){t.selection.setRng(n),t.focus(),i.clear(o)}))}}))}))}))}(t,o,a,c),function(n,t,e){var r=function(t){return function(){return n.execCommand(t)}},o=function(t){var e=t.numRows,r=t.numColumns;n.undoManager.transact((function(){Gc(n,r,e,0,0)})),n.addVisual()},u={text:"Table properties",onSetup:t.onSetupTable,onAction:r("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:r("mceTableDelete")};n.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(e.getColumns)}),n.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(e.getColumns)}),n.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:t.onSetupMergeable}),n.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:t.onSetupUnmergeable}),!1===n.getParam("table_grid",!0,"boolean")?n.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):n.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),n.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),n.ui.registry.addMenuItem("tableprops",u),n.ui.registry.addMenuItem("deletetable",i),n.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),n.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn"}}),n.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),n.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold((function(){return""}),(function(n){return"caption"===J(n.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})}(t,u,l),function(n,t,e){n.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(t){return function(){return n.execCommand(t)}};n.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),n.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),n.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(e.getColumns)}),n.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(e.getColumns)}),n.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(t,u,l),function(n){var t=n.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol");0<t.length&&n.ui.registry.addContextToolbar("table",{predicate:function(t){return n.dom.is(t,"table")&&n.getBody().contains(t)},items:t,scope:"node",position:"node"})}(t),t.on("PreInit",(function(){t.serializer.addTempAttr(or),t.serializer.addTempAttr(ir),function(n){n.formatter.register(Cf)}(t)})),function(n){return n.getParam("table_tab_navigation",!0,"boolean")}(t)&&t.on("keydown",(function(n){fl(n,t,a,i.lazyWire)})),t.on("remove",(function(){i.destroy()})),function(n,t,e,r){return{insertTable:function(t,e,r){return void 0===r&&(r={}),Yc(n,e,t,r,"Invalid values for insertTable - rows and columns values are required to insert a table.")},setClipboardRows:Qc(t.setRows),getClipboardRows:Jc(t.getRows),setClipboardCols:Qc(t.setColumns),getClipboardCols:Jc(t.getColumns),resizeHandler:e,selectionTargets:r}}(t,l,i,u)}t.add("table",xf)}(window);